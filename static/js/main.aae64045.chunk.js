(this["webpackJsonp@applications/widget-editor"]=this["webpackJsonp@applications/widget-editor"]||[]).push([[0],{129:function(e,t,n){"use strict";var a=n(5),i=n(27),r=n(28),o=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function o(e){try{s(a.next(e))}catch(t){r(t)}}function c(e){try{s(a.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}s((a=a.apply(e,t||[])).next())}))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(18),u=c(n(256)),l=function(){function e(){i(this,e),this.endpoint="https://api.resourcewatch.org/v1",this.config=null,this.datasetService=null,this.widgetService=null,this.datasetId=null,this.AUTH_TOKEN=null,this.applications=["rw"],this.env="production",this.locale="en",this.widget_params=["chartType","visualizationType","limit","value","category","color","size","orderBy","aggregateFunction","filters","areaIntersection","band","layer"];var t={applications:this.applications,env:this.env,locale:this.locale};this.config=u.default(t),this.datasetService=new s.DatasetService(this.config),this.widgetService=new s.WidgetService(this.config)}return r(e,[{key:"payload",value:function(){return{applications:this.applications,env:this.env}}},{key:"saveWidgetRW",value:function(){return o(this,void 0,void 0,a.mark((function e(){var t,n;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="".concat(this.endpoint,"/dataset/").concat(this.datasetId,"/widget"),!this.AUTH_TOKEN){e.next=16;break}return e.prev=2,e.next=5,fetch(t,{method:"POST",headers:{Authorization:"Bearer ".concat(this.AUTH_TOKEN)}});case 5:return n=e.sent,e.next=8,n.json();case 8:return e.abrupt("return",e.sent);case 11:e.prev=11,e.t0=e.catch(2),console.error("Cant save widget",e.t0);case 14:e.next=17;break;case 16:console.error("Missing auth token for saveWidget (RW)");case 17:case"end":return e.stop()}}),e,this,[[2,11]])})))}},{key:"hasAuthToken",value:function(){return!!this.AUTH_TOKEN}},{key:"setDatasetId",value:function(e){e||console.error("Error: datasetId is required"),this.datasetId=e}},{key:"getDataset",value:function(){return o(this,void 0,void 0,a.mark((function e(){var t,n,i,r,o,c,s;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.config.getConfig(),n=t.applications,i=t.env,r=t.locale,"metadata,vocabulary,widget,layer",o="".concat(this.endpoint,"/dataset/").concat(this.datasetId,"?").concat(n.join(","),"&env=").concat(i,"&language=").concat(r,"&includes=").concat("metadata,vocabulary,widget,layer","&page[size]=999"),e.next=5,this.datasetService.fetchData(o);case 5:return c=e.sent,s=c.data,e.abrupt("return",s);case 8:case"end":return e.stop()}}),e,this)})))}},{key:"getFields",value:function(){return o(this,void 0,void 0,a.mark((function e(){var t,n,i;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(this.endpoint,"/fields/").concat(this.datasetId),e.next=3,this.datasetService.fetchData(t);case 3:return n=e.sent,i=n.fields,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"getWidget",value:function(e){return o(this,void 0,void 0,a.mark((function t(){var n,i,r,o,c,s,u,l;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.config.getConfig(),i=n.applications,r=n.env,o=n.locale,"metadata",c=this.widgetService.fromDataset(e).id,s="".concat(this.endpoint,"/widget/").concat(c,"?").concat(i.join(","),"&env=").concat(r,"&language=").concat(o,"&includes=").concat("metadata","&page[size]=999"),t.next=6,this.widgetService.fetchWidget(s);case 6:return u=t.sent,l=u.data,t.abrupt("return",l);case 9:case"end":return t.stop()}}),t,this)})))}},{key:"getWidgetData",value:function(e,t){return o(this,void 0,void 0,a.mark((function n(){var i,r,o,c;return a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=this.widgetService.getDataSqlQuery(e,t),r="".concat(this.endpoint,"/query/").concat(this.datasetId,"?sql=").concat(i),n.next=4,this.widgetService.fetchWidgetData(r);case 4:return o=n.sent,c=o.data,n.abrupt("return",c);case 7:case"end":return n.stop()}}),n,this)})))}},{key:"getLayers",value:function(){return o(this,void 0,void 0,a.mark((function e(){var t,n,i,r,o,c;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.config.getConfig(),n=t.applications,i=t.env,t.locale,r="".concat(this.endpoint,"/dataset/").concat(this.datasetId,"/layer?app=").concat(n.join(","),"&env=").concat(i,"&page[size]=9999"),e.next=4,this.datasetService.fetchData(r);case 4:return o=e.sent,c=o.data,e.abrupt("return",c);case 7:case"end":return e.stop()}}),e,this)})))}}]),e}();t.default=l},135:function(e,t,n){e.exports=n(259)},140:function(e,t,n){},145:function(e,t,n){"use strict";var a=n(5),i=n(27),r=n(28),o=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function o(e){try{s(a.next(e))}catch(t){r(t)}}function c(e){try{s(a.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}s((a=a.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(t){i(this,e),this.config=t}return r(e,[{key:"fetchData",value:function(e){return o(this,void 0,void 0,a.mark((function t(){var n;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(e);case 3:if(!((n=t.sent).status>=400)){t.next=6;break}throw new Error(n.statusText);case 6:return t.next=8,n.json();case 8:return t.abrupt("return",t.sent);case 11:throw t.prev=11,t.t0=t.catch(0),new Error(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))}}]),e}();t.default=c},147:function(e,t,n){"use strict";var a=n(5),i=n(27),r=n(28),o=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function o(e){try{s(a.next(e))}catch(t){r(t)}}function c(e){try{s(a.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}s((a=a.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var c=n(94),s=function(){function e(t){i(this,e),this.config=t}return r(e,[{key:"fromDataset",value:function(e){return c.find(e.attributes.widget,(function(e){return!!e.attributes.defaultEditableWidget}))}},{key:"getDataSqlQuery",value:function(e,t){return""}},{key:"fetchWidgetData",value:function(e){return o(this,void 0,void 0,a.mark((function e(){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 1:case"end":return e.stop()}}),e)})))}},{key:"fetchWidget",value:function(e){return o(this,void 0,void 0,a.mark((function t(){var n;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(e);case 3:if(!((n=t.sent).status>=400)){t.next=6;break}throw new Error(n.statusText);case 6:return t.next=8,n.json();case 8:return t.abrupt("return",t.sent);case 11:throw t.prev=11,t.t0=t.catch(0),new Error(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))}}]),e}();t.default=s},148:function(e,t,n){"use strict";var a=n(149),i=n(5),r=n(27),o=n(28),c=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function o(e){try{s(a.next(e))}catch(t){r(t)}}function c(e){try{s(a.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}s((a=a.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=s(n(72)),l=n(95),d=function(){function e(t,n,a,i){r(this,e),this.adapter=n,this.setEditor=a,this.dispatch=i,this.dataset=null,this.widget=null,this.adapter.setDatasetId(t)}return o(e,[{key:"getDatasetAndWidgets",value:function(){return c(this,void 0,void 0,i.mark((function e(){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.adapter.getDataset();case 2:return this.dataset=e.sent,e.next=5,this.adapter.getWidget(this.dataset);case 5:this.widget=e.sent,this.setEditor({dataset:this.dataset,widget:this.widget}),this.dispatch({type:l.sagaEvents.DATA_FLOW_DATASET_WIDGET_READY});case 8:case"end":return e.stop()}}),e,this)})))}},{key:"getWidgetData",value:function(){return c(this,void 0,void 0,i.mark((function e(){var t,n,a;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.widget.attributes.widgetConfig.paramsConfig,n=new u.default(t),e.next=4,n.requestWidgetData();case 4:a=e.sent,this.setEditor({widgetData:a.data}),this.dispatch({type:l.sagaEvents.DATA_FLOW_WIDGET_DATA_READY});case 7:case"end":return e.stop()}}),e,this)})))}},{key:"getFieldsAndLayers",value:function(){return c(this,void 0,void 0,i.mark((function e(){var t,n;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.adapter.getFields();case 2:return t=e.sent,e.next=5,this.adapter.getLayers();case 5:n=e.sent,this.setEditor({layers:n,fields:t}),this.dispatch({type:l.sagaEvents.DATA_FLOW_DATA_READY});case 8:case"end":return e.stop()}}),e,this)})))}},{key:"resolveUpdates",value:function(e,t){var n={};return this.adapter.widget_params.forEach((function(t){t in e?n=Object.assign(Object.assign({},n),a({},t,e[t])):console.warn("Widget Editor: Param(".concat(t,") does not exsist in widget, make sure adapter.widget_params has fields that match with your API widget payload. Refer to documentation for adapter.widget_params for aditional information."))})),Object.assign(Object.assign({},this.adapter.payload()),{title:e.title||null,description:e.description||null,widget:{params:n,data:t.data||null,scales:t.scales||null,axes:t.axes||null,marks:t.marks||null,interaction_config:t.interaction_config||null,config:t.config||null}})}},{key:"resolveInitialState",value:function(){return c(this,void 0,void 0,i.mark((function e(){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDatasetAndWidgets();case 2:return e.next=4,this.getWidgetData();case 4:return e.next=6,this.getFieldsAndLayers();case 6:case"end":return e.stop()}}),e,this)})))}}]),e}();t.default=d},150:function(e,t,n){"use strict";var a=n(27),i=n(28),r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(151)),c=r(n(152)),s=n(153),u=n(54),l=function(){function e(t,n,i){a(this,e),this.schema=u.defaultVegaSchema(),this.widgetConfig=t,this.widgetData=n,this.configuration=i,this.setConfig(),this.resolveChart()}return i(e,[{key:"resolveChart",value:function(){var e,t=this.configuration.chartType;if(-1===s.SUPPORTED_CHARTS.indexOf(t))throw new Error("Chart of type: ".concat(t," is not supported. we support: (").concat(s.SUPPORTED_CHARTS.join("|"),")"));"pie"===t&&(e=new o.default(this.schema,this.widgetConfig,this.widgetData).getChart()),"bar"===t&&(e=new c.default(this.schema,this.widgetConfig,this.widgetData).getChart()),this.schema=Object.assign(Object.assign({},this.schema),e)}},{key:"setConfig",value:function(){this.schema=Object.assign(Object.assign({},this.schema),{config:this.widgetConfig.config})}},{key:"getChart",value:function(){return this.schema}}]),e}();t.default=l},151:function(e,t,n){"use strict";var a=n(27),i=n(28);Object.defineProperty(t,"__esModule",{value:!0});var r=n(54),o=function(){function e(t,n,i){a(this,e),this.schema=t,this.widgetConfig=n,this.widgetData=i,this.generateSchema(),this.setGenericSettings()}return i(e,[{key:"generateSchema",value:function(){this.schema=Object.assign(Object.assign({},this.schema),{scales:this.setScales(),marks:this.setMarks(),data:this.bindData()})}},{key:"setGenericSettings",value:function(){this.schema=Object.assign(Object.assign({},this.schema),{width:400,height:400})}},{key:"setScales",value:function(){return[{name:"c",type:"ordinal",domain:{data:"table",field:r.sqlFields.value},range:{scheme:"category20"}}]}},{key:"setMarks",value:function(){return[{type:"arc",from:{data:"table"},encode:{enter:{fill:{scale:"c",field:r.sqlFields.value},x:{signal:"width / 2"},y:{signal:"height / 2"}},update:{startAngle:{field:"startAngle"},endAngle:{field:"endAngle"},innerRadius:{signal:"width > height ? height / 3 : width / 3"},outerRadius:{signal:"width > height ? height / 2 : width / 2"}},hover:{opacity:{value:.8}}}}]}},{key:"bindData",value:function(){return[{values:this.widgetData,name:"table",transform:[{type:"pie",field:r.sqlFields.category,startAngle:0,endAngle:6.29}]}]}},{key:"getChart",value:function(){return this.schema}}]),e}();t.default=o},152:function(e,t,n){"use strict";var a=n(27),i=n(28);Object.defineProperty(t,"__esModule",{value:!0});var r=n(54),o=function(){function e(t,n,i){a(this,e),this.schema=t,this.widgetConfig=n,this.widgetData=i,this.generateSchema(),this.setGenericSettings()}return i(e,[{key:"generateSchema",value:function(){this.schema=Object.assign(Object.assign({},this.schema),{axes:this.setAxes(),scales:this.setScales(),marks:this.setMarks(),data:this.bindData()})}},{key:"setGenericSettings",value:function(){this.schema=Object.assign(Object.assign({},this.schema),{autosize:{type:"fit",contains:"padding"},padding:20})}},{key:"setScales",value:function(){return[{name:"xscale",type:"band",domain:{data:"table",field:r.sqlFields.value},range:"width",padding:.05,round:!0},{name:"yscale",domain:{data:"table",field:r.sqlFields.category},nice:!0,range:"height"}]}},{key:"setMarks",value:function(){return[{type:"rect",from:{data:"table"},encode:{enter:{x:{scale:"xscale",field:r.sqlFields.value},width:{scale:"xscale",band:1},y:{scale:"yscale",field:r.sqlFields.category},y2:{scale:"yscale",value:0}},update:{fill:{value:"steelblue"}},hover:{fill:{value:"red"}}}}]}},{key:"setAxes",value:function(){return[{orient:"bottom",scale:"xscale"},{orient:"left",scale:"yscale"}]}},{key:"bindData",value:function(){return[{values:this.widgetData,name:"table"}]}},{key:"getChart",value:function(){return this.schema}}]),e}();t.default=o},153:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SUPPORTED_CHARTS=["pie","bar"],t.default={SUPPORTED_CHARTS:t.SUPPORTED_CHARTS}},154:function(e,t,n){"use strict";var a=n(5),i=n(27),r=n(28),o=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function o(e){try{s(a.next(e))}catch(t){r(t)}}function c(e){try{s(a.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}s((a=a.apply(e,t||[])).next())}))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=c(n(72)),u=c(n(31)),l=function(){function e(){i(this,e),this.cache={limit:null,chartType:null,value:null,orderBy:null}}return r(e,[{key:"checkHasUpdate",value:function(e){var t=this,n=Object.keys(this.cache),a=!1;return n.forEach((function(n){a=a||!u.default(t.cache[n],e[n])})),a}},{key:"cacheCurrent",value:function(e){this.cache=e}},{key:"sync",value:function(e){return o(this,void 0,void 0,a.mark((function t(){var n,i,r;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=this.checkHasUpdate(e))){t.next=8;break}return this.cacheCurrent(e),i=new s.default(e),t.next=6,i.requestWidgetData();case 6:return r=t.sent,t.abrupt("return",{hasUpdates:n,widgetData:r.data});case 8:return t.abrupt("return",{hasUpdates:n,widgetData:null});case 9:case"end":return t.stop()}}),t,this)})))}}]),e}();t.default=l},18:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(145));t.DatasetService=i.default;var r=a(n(147));t.WidgetService=r.default;var o=a(n(72));t.FiltersService=o.default;var c=a(n(148));t.DataService=c.default;var s=a(n(150));t.VegaService=s.default;var u=a(n(154));t.StateProxy=u.default;var l=a(n(95));t.constants=l.default},256:function(e,t,n){"use strict";var a=n(27),i=n(28);Object.defineProperty(t,"__esModule",{value:!0});var r=n(94),o=function(){function e(t){a(this,e),this.setConfig(t)}return i(e,[{key:"setConfig",value:function(e){var t=r.pick(e,["url","env","applications","authUrl","assetsPath","userToken","userEmail","locale"]);this.config=Object.assign(Object.assign({},this.config),t)}},{key:"getConfig",value:function(){return this.config}}]),e}();t.default=function(e){return new o(e)}},257:function(e,t,n){},258:function(e,t,n){},259:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"setEditor",(function(){return M})),n.d(a,"default",(function(){return W}));var i={};n.r(i),n.d(i,"setTheme",(function(){return R})),n.d(i,"default",(function(){return q}));var r={};n.r(r),n.d(r,"setConfiguration",(function(){return Z})),n.d(r,"patchConfiguration",(function(){return $})),n.d(r,"saveConfiguration",(function(){return ee})),n.d(r,"default",(function(){return te}));var o={};n.r(o),n.d(o,"default",(function(){return Vt}));var c={};n.r(c),n.d(c,"actions",(function(){return a})),n.d(c,"initialState",(function(){return Yt})),n.d(c,"reducers",(function(){return o}));var s={};n.r(s),n.d(s,"default",(function(){return Kt}));var u={};n.r(u),n.d(u,"actions",(function(){return i})),n.d(u,"initialState",(function(){return Xt})),n.d(u,"reducers",(function(){return s}));var l={};n.r(l),n.d(l,"setWidget",(function(){return Jt})),n.d(l,"default",(function(){return Qt}));var d={};n.r(d),n.d(d,"default",(function(){return Zt}));var f={};n.r(f),n.d(f,"actions",(function(){return l})),n.d(f,"initialState",(function(){return $t})),n.d(f,"reducers",(function(){return d}));var p={};n.r(p),n.d(p,"default",(function(){return en}));var h={};n.r(h),n.d(h,"actions",(function(){return r})),n.d(h,"initialState",(function(){return tn})),n.d(h,"reducers",(function(){return p}));var g={};n.r(g),n.d(g,"modifyOptions",(function(){return An})),n.d(g,"default",(function(){return Sn}));var v={};n.r(v),n.d(v,"default",(function(){return kn}));var m={};n.r(m),n.d(m,"actions",(function(){return g})),n.d(m,"initialState",(function(){return Dn})),n.d(m,"reducers",(function(){return v}));var b=n(1),y=n.n(b),x=n(30),w=n.n(x),O=(n(140),n(23)),E=n(13),_=n(25),j=n(122),C=n(11),A=n(10),S=n(15),k=n(16),D=n(17),T=n(26),P=n(18),I=function(e,t){return Object(O.b)((function(t){return"function"===typeof e?e(t[P.constants.APP_NAMESPACE]):{}}),t)},N=function(e){return Object(T.createAction)("".concat(P.constants.APP_NAMESPACE,"/").concat(e))},F=function(e){return"".concat(P.constants.APP_NAMESPACE,"/").concat(e)},M=N("EDITOR/setEditor"),W={setEditor:M},R=N("EDITOR/THEME/setTheme"),q={setTheme:R},L=n(3),z=n(6),B=n(31),U=n.n(B),G=n(89),H=n.n(G),V=n(66),Y=n.n(V),K=n(92),X=(n(123),z.c.div.withConfig({displayName:"component__StyledContainer",componentId:"p6fymh-0"})(["flex 1;display:flex;width:100%;.c-chart{flex:1;text-align:center;overflow:hidden;margin:20px;max-height:400px;align-self:center;}"])),J=function(e){var t=e.editor,n=e.widget,a=Object(b.useRef)(),i=Object(b.useRef)(),r=Object(b.useRef)();return Object(b.useEffect)((function(){if(a.current&&!Y()(n)&&!U()(n,r)){var e=K.b(n),t=a.current.offsetWidth;i.current=new K.a(e).initialize(a.current).renderer("canvas").width(t-40).hover().run(),r.current=n,i.current.resize=function(){var e=a.current.offsetWidth;i.current.width(e-40).run()},window.addEventListener("resize",i.current.resize)}}),[a,t,n]),y.a.createElement(X,null,y.a.createElement("div",{className:"c-chart",ref:a}))},Q=I((function(e){return{editor:e.editor,widget:e.widget}}))(J),Z=N("CONFIGURATION/setConfiguration"),$=N("CONFIGURATION/patchConfiguration"),ee=N("CONFIGURATION/saveConfiguration"),te={saveConfiguration:ee,setConfiguration:Z,patchConfiguration:$},ne=n(91),ae=function(e){return e.editor.dataset},ie=Object(ne.a)([function(e){return e.configuration},ae],(function(e,t){var n=t.attributes.metadata[0].attributes.columns[e.value.name];return Object(E.a)({},n,{identifier:e.value.name})})),re=Object(ne.a)([ae],(function(e){return e.attributes.widgetRelevantProps.map((function(t){return Object(E.a)({},e.attributes.metadata[0].attributes.columns[t],{identifier:t})}))})),oe=z.c.div.withConfig({displayName:"flex__FlexContainer",componentId:"sc-1jjiixp-0"})(["display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;flex-flow:",";width:100%;"," label{flex-basis:100%;}"],(function(e){return e.row?"row":"column"}),(function(e){return e.row?"> * { padding-right: 20px; &:last-child { padding-right: 0; } } ":""})),ce=n(9),se=n(20),ue=n(42),le=function(){return y.a.createElement("svg",{width:"10px",height:"10px",viewBox:"0 0 10 10",version:"1.1"},y.a.createElement("g",{id:"Iteration",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},y.a.createElement("g",{id:"xAxis-Selector",transform:"translate(-183.000000, -311.000000)",fill:"#2C75B0"},y.a.createElement("g",{id:"Rectangle-409-+-364-+-MWh-Copy",transform:"translate(163.000000, 289.000000)"},y.a.createElement("g",{id:"Group-20",transform:"translate(19.000000, 10.000000)"},y.a.createElement("path",{d:"M4.5,12 L11,18.5 L7.5,22 L1,15.5 L1,12 L4.5,12 Z M3.5,13.5 C2.94771525,13.5 2.5,13.9477153 2.5,14.5 C2.5,15.0522847 2.94771525,15.5 3.5,15.5 C4.05228475,15.5 4.5,15.0522847 4.5,14.5 C4.5,13.9477153 4.05228475,13.5 3.5,13.5 Z",id:"item-category"}))))))},de=z.c.div.withConfig({displayName:"style__StyledPopupContainer",componentId:"eg9uyn-0"})(["position:absolute;box-sizing:border-box;height:auto;width:422px;border:1px solid rgba(26,28,34,0.1);border-radius:4px;background-color:#FFFFFF;box-shadow:0 20px 30px 0 rgba(0,0,0,0.1);z-index:2;bottom:40px;left:-75px;padding:20px;&:after{content:'';position:absolute;left:200px;bottom:-20px;border:10px solid transparent;border-top:10px solid #FFFFFF;z-index:3;}"]),fe=z.c.h4.withConfig({displayName:"style__StyledCategoryAlias",componentId:"eg9uyn-1"})(["position:relative;padding-left:20px;margin-bottom:10px;margin-top:0;color:#2C75B0;font-size:16px;line-height:25px;"]),pe=z.c.div.withConfig({displayName:"style__StyledCategoryDescription",componentId:"eg9uyn-2"})(["position:relative;padding-left:20px;margin-top:10px;margin-bottom:10px;color:#393F44;font-size:16px;line-height:25px;"]),he=z.c.div.withConfig({displayName:"style__StyledValueAlias",componentId:"eg9uyn-3"})(["position:relative;padding-left:20px;margin-top:10px;margin-bottom:10px;color:#393F44;font-size:16px;line-height:25px;"]),ge=z.c.div.withConfig({displayName:"style__IconBox",componentId:"eg9uyn-4"})(["color:#393F44;position:absolute;left:0;top:1px;"]),ve=function(e){var t=e.category,n=e.value.alias,a=t.alias;return y.a.createElement(de,null,y.a.createElement(fe,null,y.a.createElement(ge,null,y.a.createElement(le,null)),a),y.a.createElement(pe,null,y.a.createElement(ge,null,"#"),a," Description"),y.a.createElement(he,null,y.a.createElement(ge,null,"#"),n))},me=z.c.div.withConfig({displayName:"style__StyledSelectOptionTitle",componentId:"sc-42eb37-0"})(["font-size:14px;display:flex;align-items:center;font-weight:500;"]),be=z.c.div.withConfig({displayName:"style__StyledSelectOptionDescription",componentId:"sc-42eb37-1"})(["font-size:12px;padding-top:10px;"]),ye=z.c.div.withConfig({displayName:"style__StyledSelectOption",componentId:"sc-42eb37-2"})(["padding:10px 20px;border-bottom:1px solid #6f6f6f;color:",";&:hover{background-color:blue;cursor:pointer;color:white;}&:last-child{border-bottom:none;}"],(function(e){return e.isDisabled?"#eaeaea":"#6f6f6f"})),xe=function(e){var t=e.data,n=e.isDisabled,a=e.innerProps,i=t.description,r=t.alias;return n?null:y.a.createElement(ye,a,y.a.createElement(me,null,r),i&&i.length>0&&y.a.createElement(be,null,i))},we=z.c.div.withConfig({displayName:"style__StyledSelectBox",componentId:"sc-1braopw-0"})(["position:relative;"]),Oe={control:function(){return{display:"flex",border:"1px solid rgba(202,204,208,0.85)",borderRadius:"4px",padding:"3px 0"}}},Ee={container:function(){return{position:"relative",boxSizing:"border-box",cursor:"pointer"}},indicatorSeparator:function(){return{display:"none"}},dropdownIndicator:function(e,t){return{color:"#c32d7b",transform:t.selectProps.menuIsOpen?"rotate(180deg)":"none",transition:"all 0.2s ease-out"}},indicatorsContainer:function(){return{color:"#c32d7b",display:"flex",padding:"8px",transition:"color 150ms",boxSizing:"border-box",position:"relative",top:"5px"}},control:function(){return{display:"flex",border:"none",borderRadius:"4px",padding:"3px 0"}}};function _e(){return(_e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var je=function(e){var t=e.isCustom,n=e.isPopup,a=e.configuration,i=Object(se.a)(e,["isCustom","isPopup","configuration"]),r=a.value,o=a.category,c=Object(b.useState)(!1),s=Object(ce.a)(c,2),u=s[0],l=s[1],d=Object(b.useState)(!1),f=Object(ce.a)(d,2),p=f[0],h=f[1];return y.a.createElement(we,{onMouseEnter:function(){return l(!0)},onMouseLeave:function(){return l(!1)}},y.a.createElement(ue.a,_e({},i,{onMenuOpen:function(){return h(!0)},onMenuClose:function(){return h(!1)},styles:t?Ee:Oe,components:t?{Option:xe}:null})),n&&u&&!p&&y.a.createElement(ve,{category:o,value:r}))},Ce=z.c.div.withConfig({displayName:"component__StyledContainer",componentId:"sc-1bmwxtk-0"})(["margin:10px;flex-basis:100%;padding:10px;width:100%;max-width:300px;box-sizing:border-box;"]),Ae=function(e){e.theme;var t=e.value,n=e.columns,a=e.configuration,i=e.patchConfiguration;return y.a.createElement(oe,null,y.a.createElement(Ce,null,y.a.createElement(je,{menuPlacement:"top",defaultValue:t,onChange:function(e){i({value:Object(E.a)({},a.value,{name:e.identifier,alias:e.alias})})},getOptionLabel:function(e){return e.alias},getOptionValue:function(e){return e.identifier},options:n,configuration:a,isCustom:!0,isPopup:!0})))},Se=I((function(e){return{theme:e.theme,value:ie(e),configuration:e.configuration,widgetRelevantProps:e.editor.dataset.attributes.widgetRelevantProps,columns:re(e)}}),{patchConfiguration:$})(Ae),ke=n(40),De=n.n(ke),Te=z.c.div.withConfig({displayName:"component__StyledContainer",componentId:"sc-5wfvth-0"})(["margin:10px;"]),Pe={control:function(){return{display:"flex",border:"1px solid rgba(202,204,208,0.85)",borderRadius:"4px",padding:"3px 0"}},option:function(e){return Object(E.a)({},e)}},Ie=function(e){var t=e.patchConfiguration,n=e.options,a=e.value,i=Object(b.useState)(De()(n,{value:a})),r=Object(ce.a)(i,2),o=r[0],c=r[1];Object(b.useEffect)((function(){U()(De()(n,{value:a}),o)||c(De()(n,{value:a}))}),[o,a]);return y.a.createElement(Te,null,y.a.createElement(ue.a,{onChange:function(e){t({chartType:e.value})},value:o,options:n,styles:Pe}))},Ne=I((function(e){return{options:e.configuration.availableCharts,value:e.configuration.chartType}}),{patchConfiguration:$})(Ie),Fe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return"\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.09);\n\n  border-color: rgba(26, 28, 34, 0.1);\n  border-style: solid;\n\n  border-width: ".concat(e,"px ").concat(t,"px ").concat(n,"px ").concat(a,"px;\n")},Me=z.c.div.withConfig({displayName:"component__StyledContainer",componentId:"sc-1jp54tw-0"})(["display:flex;flex-flow:column;height:calc(100% - ",");background:#fff;flex:1;width:100%;",""],"100px",Fe()),We=function(e){var t=e.widget;return y.a.createElement(Me,null,y.a.createElement(Ne,null),y.a.createElement(Q,null),!Y()(t)&&y.a.createElement(Se,null))},Re=I((function(e){return{editor:e.editor,widget:e.widget}}))(We),qe=z.c.div.withConfig({displayName:"component__StyledAccordion",componentId:"zppq3y-0"})(["width:100%;padding-top:24px;padding-bottom:24px;"]),Le=z.c.div.withConfig({displayName:"component__StyledAccordionContent",componentId:"zppq3y-1"})(['display:"block";max-height:',";overflow-y:",";transition:all 0.2s ease-out;padding-left:24px;padding-top:",";padding-bottom:",";"],(function(e){return e.scrollHeight+"px"||!1}),(function(e){return e.scrollHeight?"visible":"hidden"}),(function(e){return e.scrollHeight?"18px":"0"}),(function(e){return e.scrollHeight?"18px":"0"})),ze=z.c.a.withConfig({displayName:"component__StyledAccordionButton",componentId:"zppq3y-2"})(['display:block;height:25px;color:#393f44;font-size:16px;font-weight:bold;line-height:25px;position:relative;padding-left:25px;cursor:pointer;&:before{content:" ";width:10px;height:10px;border-radius:50%;background:#c32d7b;position:absolute;left:0;top:8px;}']),Be=z.c.div.withConfig({displayName:"component__StyledAccordionSection",componentId:"zppq3y-3"})(['padding-top:11px;padding-bottom:11px;position:relative;&:before{content:" ";height:1px;width:calc(100% - 24px);display:block;position:absolute;top:0;background-color:#d2d3d6;margin-left:24px;}&:first-child{&:before{display:none;}}']),Ue=function(e){var t=e.title,n=e.openDefault,a=e.children,i=Object(b.useRef)(null),r=Object(b.useState)(0),o=Object(ce.a)(r,2),c=o[0],s=o[1],u=function(){var e=i.current,t=c?0:e.scrollHeight;s(t)};return Object(b.useEffect)((function(){n&&u()}),[]),y.a.createElement(Be,null,y.a.createElement(ze,{onClick:function(){return u()}},t),y.a.createElement(Le,{ref:i,scrollHeight:c},a))},Ge=function(e){var t=e.children;return y.a.createElement(qe,null,t)};function He(){return(He=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var Ve=z.c.button.withConfig({displayName:"component__StyledButton",componentId:"l5yyzu-0"})(["cursor:pointer;font-size:16px;color:#393f44;border:1px solid rgba(202,204,208,0.85);background:transparent;padding:10px 20px;border-radius:5px;outline:0;"," "," "," ",""],(function(e){return e.type&&"cta"===e.type&&Object(z.b)(["background:",";color:#fff;border:1px solid transparent;"],e.color)}),(function(e){return e.type&&"highlight"===e.type&&Object(z.b)(["color:",";border:1px solid ",";"],e.color,e.color)}),(function(e){return e.type&&"default"===e.type&&Object(z.b)(["&:hover,&.active{","}"],(function(e){return e.color&&Object(z.b)(["border:1px solid ",";color:",";"],e.color,e.color)}))}),(function(e){return e.active&&Object(z.b)(["border:1px solid ",";color:",";"],e.color,e.color)})),Ye=function(e){var t=e.type,n=void 0===t?"default":t,a=e.theme,i=e.children,r=Object(se.a)(e,["type","theme","children"]);return y.a.createElement(Ve,He({},r,{color:a.color,type:n}),i)},Ke=I((function(e){return{theme:e.theme}}))(Ye),Xe=z.c.div.withConfig({displayName:"style__StyledTabsContainer",componentId:"qvkojo-0"})(["position:relative;"]),Je=z.c.div.withConfig({displayName:"style__StyledTabsContent",componentId:"qvkojo-1"})(["display:",";"],(function(e){return e.active?"block":"none"})),Qe=z.c.ul.withConfig({displayName:"style__StyledList",componentId:"qvkojo-2"})(["display:flex;justify-content:space-between;padding:20px 0;list-style:none;"]),Ze=z.c.li.withConfig({displayName:"style__StyledListLabel",componentId:"qvkojo-3"})(["color:red;padding-right:5px;padding-left:5px;&:first-child{padding-left:0;}&:last-child{padding-right:0;}"]);function $e(){return($e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var et=function(e){return y.a.createElement(Ke,$e({style:{height:"100%"}},e))},tt=function(e){var t=e.children,n=Object(b.useState)(0),a=Object(ce.a)(n,2),i=a[0],r=a[1];return Object(b.useEffect)((function(){var e=t.findIndex((function(e){return e.props.default}));r(-1===e?0:e)}),[]),y.a.createElement(Xe,null,y.a.createElement(Qe,null,t.map((function(e,t){var n=e.props.label;return n?y.a.createElement(Ze,{key:t},y.a.createElement(et,{onClick:function(){return r(t)},active:t===i},n)):null}))),t.map((function(e,t){var n=e.props.children;return y.a.createElement(Je,{key:t,active:t===i},n)})))},nt=function(e){var t=e.children;return e.label?t:null},at=n(127);function it(){return(it=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var rt=Object(z.c)(at.a).withConfig({displayName:"component__StyledSlider",componentId:"ps9f57-0"})(["height:7px;width:inherit;"]),ot=z.c.div.withConfig({displayName:"component__StyledThumb",componentId:"ps9f57-1"})(["height:18px;line-height:18px;width:18px;background-color:#fff;border:3px solid ",";border-radius:50%;transform:translateY(-50%);top:50%;cursor:grab;"],(function(e){return e.theme.slider.track})),ct=z.c.div.withConfig({displayName:"component__StyledTrack",componentId:"ps9f57-2"})(["top:0;bottom:0;background:",";border-radius:999px;"],(function(e){return 2===e.index?e.theme.slider.track:1===e.index?e.theme.slider.trackBackground:e.theme.slider.track})),st=function(e,t){return y.a.createElement(ot,e)},ut=function(e,t){return y.a.createElement(ct,it({},e,{index:t.index}))},lt=function(e){var t=e.min,n=void 0===t?1:t,a=e.max,i=void 0===a?500:a,r=e.defaultValue,o=void 0===r?500:r,c=e.value,s=e.theme,u=e.onDone,l=e.onChange;return y.a.createElement(z.a,{theme:s},y.a.createElement(rt,{onAfterChange:u,onChange:l,renderTrack:ut,renderThumb:st,value:Number(c),max:i,min:n,defaultValue:o}))},dt=I((function(e){return{theme:e.theme}}))(lt);var ft=function(e,t){var n=Object(b.useState)(e),a=Object(ce.a)(n,2),i=a[0],r=a[1];return Object(b.useEffect)((function(){var n=setTimeout((function(){r(e)}),t);return function(){clearTimeout(n)}}),[e,t]),i},pt=z.c.div.withConfig({displayName:"slider-and-input__SliderAndInput",componentId:"sc-1prartq-0"})(["display:flex;width:100%;align-items:center;> div{flex:1;}> input{width:50px;flex-grow:0;margin-left:40px;}"]),ht=z.c.label.withConfig({displayName:"form-label__FormLabel",componentId:"dg5fl6-0"})(["display:block;padding:0 0 10px 0;color:#393f44;font-weight:700;font-size:13px;"]),gt=z.c.input.withConfig({displayName:"input__Input",componentId:"sc-1ao902g-0"})(['width:100%;box-sizing:border-box;padding:14px 10px;background:#ffffff;border:1px solid rgba(202,204,208,0.85);border-radius:4px;color:#393f44;font-size:14px;&[type="number"]{box-sizing:content-box;text-align:center;}']),vt=function(e){e.theme;var t=e.limit,n=e.patchConfiguration,a=Object(b.useState)("".concat(t)),i=Object(ce.a)(a,2),r=i[0],o=i[1],c=ft(r,500),s=function(e){o(e)};return Object(b.useEffect)((function(){c!==t&&null!==c&&n({limit:c})}),[c]),y.a.createElement(oe,null,y.a.createElement(ht,{htmlFor:"options-limit"},"Limit"),y.a.createElement(pt,null,y.a.createElement(dt,{onChange:s,value:r}),y.a.createElement(gt,{type:"number",name:"options-limit",min:"1",max:"500",value:r,onChange:function(e){return s(e.target.value)}})))},mt=I((function(e){return{theme:e.theme,limit:e.configuration.limit}}),{patchConfiguration:$})(vt),bt=z.c.div.withConfig({displayName:"input-group__InputGroup",componentId:"sc-1dcephl-0"})(["width:100%;margin:0 0 15px 0;"]),yt=function(e,t){return e!==t&&null!==e},xt=function(e){e.theme;var t=e.configuration,n=e.patchConfiguration,a=Object(b.useState)(t.title),i=Object(ce.a)(a,2),r=i[0],o=i[1],c=Object(b.useState)(t.caption),s=Object(ce.a)(c,2),u=s[0],l=s[1],d=Object(b.useState)(t.category.alias||""),f=Object(ce.a)(d,2),p=f[0],h=f[1],g=Object(b.useState)(t.value.alias||""),v=Object(ce.a)(g,2),m=v[0],x=v[1],w=ft(r,500),O=ft(u,500),_=ft(p,500),j=ft(m,500),C=function(e,t){"title"===t&&o(e),"caption"===t&&l(e),"xaxis"===t&&h(e),"yaxis"===t&&x(e)};return Object(b.useEffect)((function(){yt(w,t.title)&&n({title:w}),yt(O,t.caption)&&n({caption:O}),yt(_,t.category.name)&&n({category:Object(E.a)({},t.category,{alias:_})}),yt(j,t.value.name)&&n({value:Object(E.a)({},t.value,{alias:j})})}),[w,O,_,j]),y.a.createElement(oe,null,y.a.createElement(bt,null,y.a.createElement(ht,{htmlFor:"options-title"},"Title"),y.a.createElement(gt,{type:"text",placeholder:"Add title",name:"options-title",value:r,onChange:function(e){return C(e.target.value,"title")}})),y.a.createElement(bt,null,y.a.createElement(ht,{htmlFor:"options-title"},"Caption"),y.a.createElement(gt,{type:"text",placeholder:"Add caption",name:"options-capton",value:u,onChange:function(e){return C(e.target.value,"caption")}})),y.a.createElement(oe,{row:!0},y.a.createElement(bt,null,y.a.createElement(ht,{htmlFor:"options-x-axis"},"X axis"),y.a.createElement(gt,{type:"text",placeholder:"Overwrite axis name",name:"options-x-axis",value:p,onChange:function(e){return C(e.target.value,"xaxis")}})),y.a.createElement(bt,null,y.a.createElement(ht,{htmlFor:"options-y-axis"},"Y axis"),y.a.createElement(gt,{type:"text",placeholder:"Overwrite axis name",name:"options-y-axis",value:m,onChange:function(e){return C(e.target.value,"yaxis")}}))))},wt=I((function(e){return{theme:e.theme,configuration:e.configuration}}),{patchConfiguration:$})(xt),Ot={control:function(){return{display:"flex",border:"1px solid rgba(202,204,208,0.85)",borderRadius:"4px",padding:"3px 0"}},option:function(e){return Object(E.a)({},e)}},Et=[{label:"Ascending",value:"asc"},{label:"Descending",value:"desc"}],_t=function(e){var t=e.orderBy,n=e.patchConfiguration,a=Object(b.useState)(De()(Et,{value:t.orderType})),i=Object(ce.a)(a,2),r=i[0],o=i[1];Object(b.useEffect)((function(){t.orderType!==r.value&&o(De()(Et,{value:t.orderType}))}),[t,r.value]);return y.a.createElement(oe,null,y.a.createElement(bt,null,y.a.createElement(ht,{htmlFor:"options-title"},"Ascending or Descending"),y.a.createElement(ue.a,{onChange:function(e){n({orderBy:Object(E.a)({},t,{orderType:e.value})})},value:r,options:Et,styles:Ot})))},jt=I((function(e){return{orderBy:e.configuration.orderBy}}),{patchConfiguration:$})(_t),Ct=z.c.div.withConfig({displayName:"style__StyledTableBox",componentId:"sc-1dqyv6r-0"})(["width:100%;height:100%;overflow:auto;"]),At=z.c.table.withConfig({displayName:"style__StyledTable",componentId:"sc-1dqyv6r-1"})(["border-collapse:separate;border-spacing:0;width:100%;padding:0;border-radius:4px;overflow:hidden;border:1px solid rgba(26,28,34,.1);font-size:14px;margin-bottom:20px;"]),St=z.c.tr.withConfig({displayName:"style__StyledTr",componentId:"sc-1dqyv6r-2"})(["background-color:#fff;box-sizing:border-box;"]),kt=z.c.td.withConfig({displayName:"style__StyledTd",componentId:"sc-1dqyv6r-3"})(["width:100%;padding:20px;text-align:",";"],(function(e){return e.center?"center":"left"})),Dt=z.c.td.withConfig({displayName:"style__StyledTh",componentId:"sc-1dqyv6r-4"})(["position:relative;font-size:14px;color:#393f44;font-weight:700;white-space:nowrap;padding:20px;"]),Tt=function(e){var t=e.widgetData,n=e.configuration,a=n.value.alias,i=n.category.alias;return y.a.createElement(Ct,null,y.a.createElement(At,null,y.a.createElement("thead",null,y.a.createElement(St,null,y.a.createElement(Dt,null,i),y.a.createElement(Dt,null,a))),y.a.createElement("tbody",null,t&&t.map((function(e){return y.a.createElement(St,{key:e.x},y.a.createElement(kt,null,e.x),y.a.createElement(kt,{center:!0},e.y))})))))},Pt=I((function(e){return{widgetData:e.editor.widgetData,configuration:e.configuration}}))(Tt),It=z.c.div.withConfig({displayName:"component__StyledContainer",componentId:"sc-1tx06u6-0"})(["flex:1;background:#fff;height:calc(100% - "," - 20px);padding:0 30px;margin:10px 0;overflow-y:scroll;",""],"100px",Fe(1,1,1,0)),Nt=function(){return y.a.createElement(It,null,y.a.createElement(tt,null,y.a.createElement(nt,{label:"General"},y.a.createElement(Ge,null,y.a.createElement(Ue,{title:"Description and labels",openDefault:!0},y.a.createElement(wt,null)),y.a.createElement(Ue,{title:"Filters"},y.a.createElement(mt,null)),y.a.createElement(Ue,{title:"Order"},y.a.createElement(jt,null)))),y.a.createElement(nt,{label:"Visual style"},"Visual style"),y.a.createElement(nt,{label:"Advanced"},"Advanced"),y.a.createElement(nt,{label:"Table view"},y.a.createElement(Pt,null))))},Ft=I((function(e){return{limit:e.configuration.limit}}),{patchConfiguration:$})(Nt),Mt=z.c.footer.withConfig({displayName:"component__StyledFooter",componentId:"t079zl-0"})(["width:100%;height:",";align-self:flex-end;display:flex;align-items:center;justify-content:space-between;padding:0 30px;"],"100px"),Wt=function(e){var t=e.authenticated,n=e.onSave;return y.a.createElement(Mt,null,y.a.createElement(Ke,{type:"highlight"},"Need help?"),t&&y.a.createElement(Ke,{type:"cta",onClick:n},"Save widget"))},Rt=I((function(e){return{authenticated:e.editor.authenticated}}))(Wt);function qt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Lt,zt=z.c.div.withConfig({displayName:"component__StyledContainer",componentId:"sc-1mx32o6-0"})(["width:100%;height:100%;display:flex;flex-flow:wrap;justify-content:space-between;flex-flow:column;@media only screen and (min-width:768px){flex-flow:wrap;}"]),Bt=function(e){function t(e){var n;Object(C.a)(this,t),n=Object(S.a)(this,Object(k.a)(t).call(this,e)),qt(Object(L.a)(n),"resolveAuthentication",H()((function(e){(0,n.props.setEditor)({authenticated:e})}),1e3)),qt(Object(L.a)(n),"resolveTheme",H()((function(e){(0,n.props.setTheme)(e)}),1e3));var a=n.props,i=(a.onSave,a.datasetId),r=a.adapter,o=a.setEditor,c=a.dispatch;return n.onSave=n.onSave.bind(Object(L.a)(n)),n.dataService=new P.DataService(i,r,o,c),n.dataService.resolveInitialState(),n}return Object(D.a)(t,e),Object(A.a)(t,[{key:"componentWillMount",value:function(){var e=this.props,t=e.authenticated;e.dispatch;t&&this.resolveAuthentication()}},{key:"componentDidUpdate",value:function(e){var t=e.datasetId,n=e.theme,a=e.authenticated,i=this.props,r=i.datasetId,o=i.theme,c=i.authenticated;U()(r,t)||alert("Need to restore editor!"),U()(o,n)||this.resolveTheme(o),U()(c,a)||this.resolveAuthentication(c)}},{key:"onSave",value:function(){var e=this.props,t=e.onSave,n=e.dispatch,a=e.configuration,i=e.widget;"function"===typeof t&&t(this.dataService.resolveUpdates(a,i)),n({type:P.constants.sagaEvents.EDITOR_SAVE})}},{key:"render",value:function(){var e=this.props.configuration;return y.a.createElement(zt,null,y.a.createElement(Re,null),e.limit&&y.a.createElement(Ft,null),y.a.createElement(Rt,{onSave:this.onSave}))}}]),t}(y.a.Component),Ut=I((function(e){return{editor:e.editor,configuration:e.configuration,widget:e.widget}}),(function(e){return{dispatch:e,setEditor:function(t){return e(M(t))},setTheme:function(t){return e(R(t))}}}))(Bt),Gt=function(e){function t(){return Object(C.a)(this,t),Object(S.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(D.a)(t,e),Object(A.a)(t,[{key:"render",value:function(){var e=this.props,t=e.authenticated,n=e.onSave,a=e.datasetId,i=e.adapter,r=e.theme;if("function"!==typeof i)throw new Error("Widget editor: Missing prop adapter and adapter needs to be of type Adapter");return y.a.createElement(Ut,{authenticated:t,onSave:n,datasetId:a,adapter:new i,theme:r})}}]),t}(y.a.Component),Ht=n(2),Vt=Object(Ht.a)({},M,(function(e,t){var n=t.payload;return Object(E.a)({},e,{},n)})),Yt={authenticated:!1,dataset:null,widget:null,widgetData:null},Kt=Object(Ht.a)({},R,(function(e,t){var n=t.payload;return Object(E.a)({},e,{},n)})),Xt={color:"#C32D7B",slider:{track:"#a3daf3",trackBackground:"#f5f5f5"}},Jt=N("WIDGET/setWidget"),Qt={setWidget:Jt},Zt=Object(Ht.a)({},Jt,(function(e,t){var n=t.payload;return Object(E.a)({},e,{},n)})),$t={},en=(Lt={},Object(Ht.a)(Lt,Z,(function(e,t){var n=t.payload;return Object(E.a)({},e,{},n)})),Object(Ht.a)(Lt,$,(function(e,t){var n=t.payload;return Object(E.a)({},e,{},n)})),Lt),tn={title:"",caption:"",visualizationType:"chart",chartType:"pie",availableCharts:[{value:"pie",label:"pie"},{value:"bar",label:"Bars"}]},nn={configuration:Object(T.handleModule)(h),editor:Object(T.handleModule)(c),theme:Object(T.handleModule)(u),widget:Object(T.handleModule)(f)},an=Object(Ht.a)({},P.constants.APP_NAMESPACE,Object(_.combineReducers)(nn)),rn=n(130),on=Object(rn.a)(),cn=n(5),sn=n.n(cn),un=n(19),ln=sn.a.mark(fn),dn=sn.a.mark(pn);function fn(){var e,t,n,a,i,r;return sn.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,Object(un.e)();case 2:return e=o.sent,t=e.widgetEditor.editor.widget.attributes,n=t.name,a=t.description,i=t.widgetConfig,r=Object(E.a)({},i.paramsConfig,{title:n,caption:a}),o.next=10,Object(un.d)(Z(r));case 10:case"end":return o.stop()}}),ln)}function pn(){return sn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(un.f)(P.constants.sagaEvents.DATA_FLOW_DATASET_WIDGET_READY,fn);case 2:case"end":return e.stop()}}),dn)}var hn=sn.a.mark(yn),gn=sn.a.mark(xn),vn=sn.a.mark(wn),mn=sn.a.mark(On),bn=new P.StateProxy;function yn(){var e,t,n,a,i,r,o;return sn.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(un.e)();case 2:return e=c.sent,t=e.widgetEditor,n=t.editor,a=t.configuration,i=n.widgetData,r=n.widget.attributes.widgetConfig,o=new P.VegaService(r,i,a),c.next=11,Object(un.d)(Jt(o.getChart()));case 11:bn.cacheCurrent(a);case 12:case"end":return c.stop()}}),hn)}function xn(){var e,t,n;return sn.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(un.e)();case 2:return e=a.sent,t=e.widgetEditor.configuration,a.next=6,Object(un.b)([bn,"sync"],t);case 6:if(!(n=a.sent).hasUpdates){a.next=15;break}if(!n.widgetData){a.next=13;break}return a.next=11,Object(un.d)(M({widgetData:n.widgetData}));case 11:return a.next=13,Object(un.b)(wn);case 13:return a.next=15,Object(un.f)(P.constants.sagaEvents.DATA_FLOW_PROXY_UPDATE,wn);case 15:case"end":return a.stop()}}),gn)}function wn(){var e,t,n,a,i,r,o;return sn.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(un.e)();case 2:return e=c.sent,t=e.widgetEditor,n=t.editor,a=t.configuration,i=n.widgetData,r=n.widget.attributes.widgetConfig,o=new P.VegaService(r,i,a),c.next=11,Object(un.d)(Jt(o.getChart()));case 11:case"end":return c.stop()}}),vn)}function On(){return sn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(un.f)(P.constants.sagaEvents.DATA_FLOW_VISUALISATION_READY,yn);case 2:return e.next=4,Object(un.f)(F("CONFIGURATION/patchConfiguration"),xn);case 4:case"end":return e.stop()}}),mn)}var En=sn.a.mark(_n);function _n(){return sn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(un.a)([Object(un.c)(pn),Object(un.c)(On)]);case 2:case"end":return e.stop()}}),En)}var jn=Gt,Cn=n(128),An=Object(T.createAction)("PLAYGROUND/modifyOptions"),Sn={modifyOptions:An},kn=Object(Ht.a)({},An,(function(e,t){var n=t.payload;return Object(E.a)({},e,{},n)})),Dn={authToken:"",optionsOpen:!1,theme:{color:"#C32D7B"},dataset:"03bfb30e-829f-4299-bab9-b2be1b66b5d4"},Tn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(_.combineReducers)(Object(E.a)({editorOptions:Object(T.handleModule)(m)},an)),n=Object(_.applyMiddleware)(Cn.a,on),a=Object(j.composeWithDevTools)(n),i=Object(_.createStore)(t,e,a);return on.run(_n),{store:i}},Pn=n(129),In=n.n(Pn),Nn=function(e){function t(e){return Object(C.a)(this,t),Object(S.a)(this,Object(k.a)(t).call(this,e))}return Object(D.a)(t,e),Object(A.a)(t,[{key:"handleOnSave",value:function(e){console.log("on save called from consumer with:"),console.log(e)}},{key:"render",value:function(){var e=this.props.editorOptions,t=e.authToken,n=e.dataset,a=e.theme,i=!!t&&t.length>0;return y.a.createElement("div",{className:"widget-editor-wrapper"},y.a.createElement(jn,{datasetId:n,onSave:this.handleOnSave,authenticated:i,adapter:In.a,theme:a}))}}]),t}(y.a.Component),Fn=Object(O.b)((function(e){return{editorOptions:e.editorOptions}}),{})(Nn),Mn=(n(257),function(e){function t(){return Object(C.a)(this,t),Object(S.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(D.a)(t,e),Object(A.a)(t,[{key:"render",value:function(){var e=this.props,t=e.editorOptions,n=t.authToken,a=t.dataset,i=t.optionsOpen,r=t.theme,o=e.modifyOptions,c="c-playground-options ".concat(i?"-open":"");return y.a.createElement("div",{className:c},y.a.createElement("h4",null,"Widget editor options"),y.a.createElement("label",{htmlFor:"token"},"Auth token"),y.a.createElement("input",{id:"token",type:"text",placeholder:"Bearer token",value:n,onChange:function(e){return o({authToken:e.target.value})}}),y.a.createElement("label",{htmlFor:"dataset"},"Active Dataset"),y.a.createElement("select",{id:"dataset",value:a,onChange:function(e){return o({dataset:e.target.value})}},y.a.createElement("option",{value:"03bfb30e-829f-4299-bab9-b2be1b66b5d4"},"Forest Sector Economic Contribution"),y.a.createElement("option",{value:"a86d906d-9862-4783-9e30-cdb68cd808b8"},"Global Power Plant Database")),y.a.createElement("label",{htmlFor:"theme-color"},y.a.createElement("span",{className:"color-presentation",style:{background:r.color}})," ","THEME - Color"),y.a.createElement("input",{id:"theme-color",type:"text",placeholder:"#00000",value:r.color,onChange:function(e){return o({theme:Object(E.a)({},r,{color:e.target.value})})}}))}}]),t}(y.a.Component)),Wn=Object(O.b)((function(e){return{editorOptions:e.editorOptions}}),{modifyOptions:An})(Mn),Rn=function(e){var t=e.optionsActive,n=e.modifyOptions;return y.a.createElement("button",{onClick:function(){return n({optionsOpen:!t})}},t?"Close options":"View options")},qn=Object(O.b)((function(e){return{optionsActive:e.editorOptions.optionsOpen}}),{modifyOptions:An})(Rn);n(258);var Ln=function(){var e=Tn().store;return y.a.createElement(O.a,{store:e},y.a.createElement("div",{className:"App"},y.a.createElement("header",{className:"App-header"},"Widget editor playground",y.a.createElement(qn,null)),y.a.createElement(Fn,null),y.a.createElement(Wn,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));w.a.render(y.a.createElement(Ln,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},54:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultVegaSchema=function(){return{$schema:"https://vega.github.io/schema/vega/v5.json",width:100,height:100,data:[],legend:[],config:[],signals:[],scales:[],axes:[],marks:[]}},t.sqlFields={value:"x",category:"y"},t.default={defaultVegaSchema:t.defaultVegaSchema,sqlFields:t.sqlFields}},72:function(e,t,n){"use strict";var a=n(5),i=n(27),r=n(28),o=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function o(e){try{s(a.next(e))}catch(t){r(t)}}function c(e){try{s(a.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}s((a=a.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var c=n(54),s=function(){function e(t){i(this,e),this.configuration=t,this.sql="",this.prepareSelectStatement(),this.prepareAggregate(),this.prepareGroupBy(),this.prepareOrderBy(),this.prepareOrder(),this.prepareLimit()}return r(e,[{key:"prepareSelectStatement",value:function(){var e=this.configuration.category;this.sql="SELECT ".concat(e.name," as ").concat(c.sqlFields.value)}},{key:"prepareAggregate",value:function(){var e=this.configuration,t=e.aggregateFunction,n=e.value,a=n.name,i=n.tableName;if(t){if("SUM"!==t.toUpperCase())throw new Error("Aggragate function (".concat(t,") not implemented in filter service."));this.sql="".concat(this.sql,", SUM(").concat(a,") as ").concat(c.sqlFields.category," FROM ").concat(i)}else this.sql="".concat(this.sql,", ").concat(a," as ").concat(c.sqlFields.category," FROM ").concat(i)}},{key:"prepareGroupBy",value:function(){var e=this.configuration.groupBy;if(e){var t=e.name;this.sql="".concat(this.sql," GROUP BY ").concat(t||c.sqlFields.value)}}},{key:"prepareOrderBy",value:function(){var e=this.configuration.orderBy;if(e){var t=e.name;this.sql="".concat(this.sql," ORDER BY ").concat(t||c.sqlFields.category)}}},{key:"prepareOrder",value:function(){var e=this.configuration.orderBy.orderType;this.sql="".concat(this.sql," ").concat(e||"desc")}},{key:"prepareLimit",value:function(){var e=this.configuration.limit,t=void 0===e?500:e;this.sql="".concat(this.sql," LIMIT ").concat(t)}},{key:"requestWidgetData",value:function(){return o(this,void 0,void 0,a.mark((function e(){var t,n,i;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.configuration.value.datasetID,e.next=3,fetch("https://api.resourcewatch.org/v1/query/".concat(t,"?sql=").concat(this.sql));case 3:return n=e.sent,e.next=6,n.json();case 6:return i=e.sent,e.abrupt("return",i);case 8:case"end":return e.stop()}}),e,this)})))}}]),e}();t.default=s},95:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.APP_NAMESPACE="widgetEditor",t.sagaEvents={DATA_FLOW_DATASET_WIDGET_READY:"".concat(t.APP_NAMESPACE,"/SAGAS/DATA_FLOW/dataset_widget_ready"),DATA_FLOW_DATA_READY:"".concat(t.APP_NAMESPACE,"/SAGAS/DATA_FLOW/data_ready"),DATA_FLOW_VISUALISATION_READY:"".concat(t.APP_NAMESPACE,"/SAGAS/DATA_FLOW/visualisation_ready"),DATA_FLOW_WIDGET_DATA_READY:"".concat(t.APP_NAMESPACE,"/SAGAS/DATA_FLOW/visualisation_ready"),DATA_FLOW_PROXY_UPDATE:"".concat(t.APP_NAMESPACE,"/SAGAS/DATA_FLOW/proxy_update"),EDITOR_SAVE:"".concat(t.APP_NAMESPACE,"/CONFIGURATION/saveConfiguration")},t.default={APP_NAMESPACE:t.APP_NAMESPACE,sagaEvents:t.sagaEvents}}},[[135,1,2]]]);
//# sourceMappingURL=main.aae64045.chunk.js.map