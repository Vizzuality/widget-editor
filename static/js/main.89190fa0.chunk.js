(this["webpackJsonp@applications/widget-editor"]=this["webpackJsonp@applications/widget-editor"]||[]).push([[0],{132:function(e,t,n){"use strict";var a=n(4),r=n(34),c=n(41),i=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,c){function i(e){try{s(a.next(e))}catch(t){c(t)}}function o(e){try{s(a.throw(e))}catch(t){c(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}s((a=a.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(64),u=o(n(169)),l=function(){function e(t,n){r(this,e),this.endpoint="https://api.resourcewatch.org/v1",this.config=null,this.datasetService=null,this.widgetService=null,this.datasetId=null,this.config=u.default(t),this.datasetId=n,this.datasetService=new s.DatasetService(this.config),this.widgetService=new s.WidgetService(this.config)}return c(e,[{key:"getDataset",value:function(){return i(this,void 0,void 0,a.mark((function e(){var t,n,r,c,i,o,s;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.config.getConfig(),n=t.applications,r=t.env,c=t.locale,"metadata,vocabulary,widget,layer",i="".concat(this.endpoint,"/dataset/").concat(this.datasetId,"?").concat(n.join(","),"&env=").concat(r,"&language=").concat(c,"&includes=").concat("metadata,vocabulary,widget,layer","&page[size]=999"),e.next=5,this.datasetService.fetchData(i);case 5:return o=e.sent,s=o.data,e.abrupt("return",s);case 8:case"end":return e.stop()}}),e,this)})))}},{key:"getFields",value:function(){return i(this,void 0,void 0,a.mark((function e(){var t,n,r;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(this.endpoint,"/fields/").concat(this.datasetId),e.next=3,this.datasetService.fetchData(t);case 3:return n=e.sent,r=n.fields,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"getWidget",value:function(e){return i(this,void 0,void 0,a.mark((function t(){var n,r,c,i,o,s,u,l;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.config.getConfig(),r=n.applications,c=n.env,i=n.locale,"metadata",o=this.widgetService.fromDataset(e).id,s="".concat(this.endpoint,"/widget/").concat(o,"?").concat(r.join(","),"&env=").concat(c,"&language=").concat(i,"&includes=").concat("metadata","&page[size]=999"),t.next=6,this.widgetService.fetchWidget(s);case 6:return u=t.sent,l=u.data,t.abrupt("return",l);case 9:case"end":return t.stop()}}),t,this)})))}},{key:"getWidgetData",value:function(e,t){return i(this,void 0,void 0,a.mark((function n(){var r,c,i,o;return a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=this.widgetService.getDataSqlQuery(e,t),c="".concat(this.endpoint,"/query/").concat(this.datasetId,"?sql=").concat(r),n.next=4,this.widgetService.fetchWidgetData(c);case 4:return i=n.sent,o=i.data,n.abrupt("return",o);case 7:case"end":return n.stop()}}),n,this)})))}},{key:"getLayers",value:function(){return i(this,void 0,void 0,a.mark((function e(){var t,n,r,c,i,o;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.config.getConfig(),n=t.applications,r=t.env,t.locale,c="".concat(this.endpoint,"/dataset/").concat(this.datasetId,"/layer?app=").concat(n.join(","),"&env=").concat(r,"&page[size]=9999"),e.next=4,this.datasetService.fetchData(c);case 4:return i=e.sent,o=i.data,e.abrupt("return",o);case 7:case"end":return e.stop()}}),e,this)})))}}]),e}();t.default=l},151:function(e,t,n){e.exports=n(342)},156:function(e,t,n){},157:function(e,t,n){},159:function(e,t,n){"use strict";var a=n(4),r=n(34),c=n(41),i=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,c){function i(e){try{s(a.next(e))}catch(t){c(t)}}function o(e){try{s(a.throw(e))}catch(t){c(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}s((a=a.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(t){r(this,e),this.config=t}return c(e,[{key:"fetchData",value:function(e){return i(this,void 0,void 0,a.mark((function t(){var n;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(e);case 3:if(!((n=t.sent).status>=400)){t.next=6;break}throw new Error(n.statusText);case 6:return t.next=8,n.json();case 8:return t.abrupt("return",t.sent);case 11:throw t.prev=11,t.t0=t.catch(0),new Error(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))}}]),e}();t.default=o},160:function(e,t,n){"use strict";var a=n(4),r=n(34),c=n(41),i=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,c){function i(e){try{s(a.next(e))}catch(t){c(t)}}function o(e){try{s(a.throw(e))}catch(t){c(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}s((a=a.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(94),u=o(n(95)),l=function(){function e(t){r(this,e),this.config=t}return c(e,[{key:"fromDataset",value:function(e){return s.find(e.attributes.widget,(function(e){return!!e.attributes.defaultEditableWidget}))}},{key:"getDataSqlQuery",value:function(e,t){var n=e.attributes,a=n.provider,r=n.tableName,c=u.default(r,a);return"".concat(c," LIMIT 10")}},{key:"fetchWidgetData",value:function(e){return i(this,void 0,void 0,a.mark((function t(){var n;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(e);case 3:if(!((n=t.sent).status>=400)){t.next=6;break}throw new Error(n.statusText);case 6:return t.next=8,n.json();case 8:return t.abrupt("return",t.sent);case 11:throw t.prev=11,t.t0=t.catch(0),new Error(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))}},{key:"fetchWidget",value:function(e){return i(this,void 0,void 0,a.mark((function t(){var n;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(e);case 3:if(!((n=t.sent).status>=400)){t.next=6;break}throw new Error(n.statusText);case 6:return t.next=8,n.json();case 8:return t.abrupt("return",t.sent);case 11:throw t.prev=11,t.t0=t.catch(0),new Error(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))}}]),e}();t.default=l},161:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(162));t.default=r.default},162:function(e,t,n){"use strict";var a=n(163),r=n(34),c=n(41),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(167)),s=n(168),u=function(){function e(t,n,a){r(this,e),this.widgetConfig=t,this.configuration=a,this.data=n,this.schema=this.defaultTemplate();new o.default(this.schema)}return c(e,[{key:"defaultTemplate",value:function(){return s.defaultVegaSchema()}},{key:"setScale",value:function(){var e=this.configuration,t=e.value,n=e.chartType,r=t.name,c=this.widgetConfig.scales[0];"pie"===n&&(this.schema=Object.assign(Object.assign({},this.schema),{scales:[].concat(a(this.schema.scales),[{name:c.name,type:"ordinal",domain:Object.assign(Object.assign({},c.domain),{field:r}),range:{scheme:c.range}}])})),"bars"===n&&(this.schema=Object.assign(Object.assign({},this.schema),{scales:[{name:"xscale",type:"band",domain:{data:"table",field:"name"},range:"width",padding:.05,round:!0},{name:"yscale",domain:{data:"table",field:"estimated_generation_gwh"},nice:!0,range:"height"}]}))}},{key:"setMarks",value:function(){var e=this,t=this.configuration,n=t.value,a=t.chartType;this.schema="bars"===a?Object.assign(Object.assign({},this.schema),{marks:[{type:"rect",from:{data:"table"},encode:{enter:{x:{scale:"xscale",field:"name"},width:{scale:"xscale",band:1},y:{scale:"yscale",field:"estimated_generation_gwh"},y2:{scale:"yscale",value:0}},update:{fill:{value:"steelblue"}},hover:{fill:{value:"red"}}}}]}):Object.assign(Object.assign({},this.schema),{marks:this.widgetConfig.marks.map((function(t){return Object.assign(Object.assign({},t),{encode:Object.assign(Object.assign({},t.encode),{enter:Object.assign(Object.assign({},t.encode.enter),{fill:Object.assign(Object.assign({},t.encode.fill),{scale:e.schema.scales[0].name,field:n.name})})})})}))})}},{key:"setLegend",value:function(){this.schema=Object.assign(Object.assign({},this.schema),{legend:this.widgetConfig.legend})}},{key:"setConfig",value:function(){this.schema=Object.assign(Object.assign({},this.schema),{config:this.widgetConfig.config})}},{key:"setData",value:function(){var e=this.configuration,t=e.chartType,n=e.value,a=this.widgetConfig.data[0].transform.find((function(e){return e.type===t}));a||(a={type:"pie",field:n.name}),this.schema=Object.assign(Object.assign({},this.schema),{data:[{values:this.data,name:this.widgetConfig.data[0].name,transform:[Object.assign(Object.assign({},a),{field:n.name})]}]})}},{key:"setAxes",value:function(){var e=this.configuration;e.value;"bars"===e.chartType&&(this.schema=Object.assign(Object.assign({},this.schema),{axes:[{orient:"bottom",scale:"xscale"},{orient:"left",scale:"yscale"}]}))}},{key:"getVegaConfig",value:function(){return this.setAxes(),this.setScale(),this.setMarks(),this.setLegend(),this.setConfig(),this.setData(),this.schema}}]),e}();t.default=u},167:function(e,t,n){"use strict";var a=n(34);Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t){a(this,e),console.log("parse me!",t)}},168:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultVegaSchema=function(){return{$schema:"https://vega.github.io/schema/vega/v5.json",width:400,height:279,data:[],legend:[],config:[],signals:[],scales:[],axes:[],marks:[]}},t.default={defaultVegaSchema:t.defaultVegaSchema}},169:function(e,t,n){"use strict";var a=n(34),r=n(41);Object.defineProperty(t,"__esModule",{value:!0});var c=n(94),i=function(){function e(t){a(this,e),this.setConfig(t)}return r(e,[{key:"setConfig",value:function(e){var t=c.pick(e,["url","env","applications","authUrl","assetsPath","userToken","userEmail","locale"]);this.config=Object.assign(Object.assign({},this.config),t)}},{key:"getConfig",value:function(){return this.config}}]),e}();t.default=function(e){return new i(e)}},342:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"setEditor",(function(){return _})),n.d(a,"default",(function(){return E}));var r={};n.r(r),n.d(r,"setTheme",(function(){return k})),n.d(r,"default",(function(){return D}));var c={};n.r(c),n.d(c,"setConfiguration",(function(){return H})),n.d(c,"patchConfiguration",(function(){return K})),n.d(c,"default",(function(){return q}));var i={};n.r(i),n.d(i,"setWidget",(function(){return De})),n.d(i,"default",(function(){return Ae}));var o={};n.r(o),n.d(o,"default",(function(){return Fe}));var s={};n.r(s),n.d(s,"actions",(function(){return a})),n.d(s,"initialState",(function(){return Ge})),n.d(s,"reducers",(function(){return o}));var u={};n.r(u),n.d(u,"default",(function(){return Ve}));var l={};n.r(l),n.d(l,"actions",(function(){return r})),n.d(l,"initialState",(function(){return ze})),n.d(l,"reducers",(function(){return u}));var d={};n.r(d),n.d(d,"default",(function(){return He}));var f={};n.r(f),n.d(f,"actions",(function(){return i})),n.d(f,"initialState",(function(){return Ke})),n.d(f,"reducers",(function(){return d}));var p={};n.r(p),n.d(p,"default",(function(){return Je}));var h={};n.r(h),n.d(h,"actions",(function(){return c})),n.d(h,"initialState",(function(){return $e})),n.d(h,"reducers",(function(){return p}));var g=n(1),v=n.n(g),b=n(25),m=n.n(b),O=(n(156),n(11)),y=(n(157),n(132)),w=n.n(y),j=n(24),x=n(16),_=Object(x.createAction)("EDITOR/setEditor"),E={setEditor:_},k=Object(x.createAction)("THEME/setTheme"),D={setTheme:k},A=n(4),T=n.n(A),S=n(9),C=n(20),I=n(18),P=n(145),N=n(134),W=n(147),L=n(13),R=n(65),M=n.n(R),F={DATA_FLOW_DATASET_WIDGET_READY:"SAGAS/DATA_FLOW/dataset_widget_ready",DATA_FLOW_DATA_READY:"SAGAS/DATA_FLOW/data_ready",DATA_FLOW_VISUALISATION_READY:"SAGAS/DATA_FLOW/visualisation_ready",DATA_FLOW_WIDGET_DATA_READY:"SAGAS/DATA_FLOW/visualisation_ready"},G=n(92),U=n(135),V=n.n(U),z=(n(87),L.b.div.withConfig({displayName:"component__StyledContainer",componentId:"p6fymh-0"})(["flex 1;display:flex;width:100%;.c-chart{flex:1;text-align:center;}"])),B=function(e){var t=e.editor,n=e.widget,a=Object(g.useRef)(),r=Object(g.useRef)(),c=Object(g.useRef)();return Object(g.useEffect)((function(){if(a.current&&!V()(n)&&!M()(n,c)){var e=a.current.parentNode.offsetWidth,t=G.b(n);r.current=new G.a(t).width(e/2).initialize(a.current).renderer("canvas").hover().run(),c.current=n}}),[a,t,n]),Object(g.useEffect)((function(){var e=function(){var e=a.current.parentNode.getBoundingClientRect().width;r.current.signal("width",e/2).run("enter")};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}})),v.a.createElement(z,null,v.a.createElement("div",{className:"c-chart",ref:a}))},Y=Object(j.b)((function(e){return{editor:e.editor,widget:e.widget}}))(B),H=Object(x.createAction)("CONFIGURATION/setConfiguration"),K=Object(x.createAction)("CONFIGURATION/patchConfiguration"),q={setConfiguration:H,patchConfiguration:K},Q=n(138),J=n.n(Q),$=n(143),X=L.b.div.withConfig({displayName:"component__StyledContainer",componentId:"sc-5wfvth-0"})(["margin:10px;"]),Z={control:function(){return{display:"flex",border:"1px solid rgba(202,204,208,0.85)",borderRadius:"4px",padding:"3px 0"}}},ee=function(e){var t=e.patchConfiguration,n=e.options,a=e.value;return v.a.createElement(X,null,v.a.createElement($.a,{onChange:function(e){t({chartType:e.value})},defaultValue:J()(n,{value:a}),options:n,styles:Z}))},te=Object(j.b)((function(e){return{options:e.configuration.availableCharts,value:e.configuration.chartType}}),{patchConfiguration:K})(ee),ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return"\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.09);\n\n  border-color: rgba(26, 28, 34, 0.1);\n  border-style: solid;\n\n  border-width: ".concat(e,"px ").concat(t,"px ").concat(n,"px ").concat(a,"px;\n")},ae=L.b.div.withConfig({displayName:"component__StyledContainer",componentId:"sc-1jp54tw-0"})(["display:flex;flex-flow:column;height:calc(100% - ",");background:#fff;flex:1;width:100%;",""],"100px",ne()),re=function(){return v.a.createElement(ae,null,v.a.createElement(te,null),v.a.createElement(Y,null))},ce=L.b.button.withConfig({displayName:"component__StyledButton",componentId:"l5yyzu-0"})(["cursor:pointer;font-size:16px;color:#393f44;border:1px solid rgba(202,204,208,0.85);background:transparent;padding:10px 20px;border-radius:5px;"," "," ",""],(function(e){return e.type&&"cta"===e.type&&Object(L.a)(["background:",";color:#fff;border:1px solid transparent;"],e.color)}),(function(e){return e.type&&"highlight"===e.type&&Object(L.a)(["color:",";border:1px solid ",";"],e.color,e.color)}),(function(e){return e.type&&"default"===e.type&&Object(L.a)(["&:hover,&.active{","}"],(function(e){return e.color&&Object(L.a)(["border:1px solid ",";color:",";"],e.color,e.color)}))})),ie=function(e){var t=e.type,n=void 0===t?"default":t,a=e.theme,r=e.children;return v.a.createElement(ce,{color:a.color,type:n},r)},oe=Object(j.b)((function(e){return{theme:e.theme}}))(ie),se=L.b.div.withConfig({displayName:"component__StyledContainer",componentId:"sc-1tx06u6-0"})(["flex:1;background:#fff;height:calc(100% - "," - 20px);padding:0 30px;margin:10px 0;",""],"100px",ne(1,1,1,0)),ue=L.b.ul.withConfig({displayName:"component__StyledList",componentId:"sc-1tx06u6-1"})(["display:flex;justify-content:space-between;padding:20px 0;list-style:none;"]),le=L.b.li.withConfig({displayName:"component__StyledListItem",componentId:"sc-1tx06u6-2"})(["color:red;"]),de=function(){return v.a.createElement(se,null,v.a.createElement(ue,null,v.a.createElement(le,null,v.a.createElement(oe,null,"General")),v.a.createElement(le,null,v.a.createElement(oe,null,"Visual style")),v.a.createElement(le,null,v.a.createElement(oe,null,"Advanced")),v.a.createElement(le,null,v.a.createElement(oe,null,"Table view"))))},fe=L.b.footer.withConfig({displayName:"component__StyledFooter",componentId:"t079zl-0"})(["width:100%;height:",";align-self:flex-end;display:flex;align-items:center;justify-content:space-between;padding:0 30px;"],"100px"),pe=function(){return v.a.createElement(fe,null,v.a.createElement(oe,{type:"highlight"},"Need help?"),v.a.createElement(oe,{type:"cta"},"Save widget"))},he=L.b.div.withConfig({displayName:"component__StyledContainer",componentId:"sc-1mx32o6-0"})(["width:100%;height:100%;display:flex;flex-flow:wrap;justify-content:space-between;flex-flow:column;@media only screen and (min-width:768px){flex-flow:wrap;}"]),ge=function(e){function t(e){var n;return Object(C.a)(this,t),(n=Object(P.a)(this,Object(N.a)(t).call(this,e))).getDatasetAndWidgets(),n.getFieldsAndLayers(),n.resolveTheme(),n}return Object(W.a)(t,e),Object(I.a)(t,[{key:"componentDidUpdate",value:function(e){var t=e.theme,n=this.props.theme;M()(n,t)||this.resolveTheme()}},{key:"resolveTheme",value:function(){var e=this.props,t=e.theme;(0,e.dispatch)({type:"THEME/setTheme",payload:t})}},{key:"getDatasetAndWidgets",value:function(){var e=Object(S.a)(T.a.mark((function e(){var t,n,a,r,c,i,o;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.adapter,a=t.setEditor,r=t.dispatch,e.next=3,n.getDataset();case 3:return c=e.sent,e.next=6,n.getWidget(c);case 6:return i=e.sent,a({dataset:c,widget:i}),r({type:F.DATA_FLOW_DATASET_WIDGET_READY}),e.next=11,n.getWidgetData(c,i);case 11:o=e.sent,a({widgetData:o}),r({type:F.DATA_FLOW_WIDGET_DATA_READY});case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getFieldsAndLayers",value:function(){var e=Object(S.a)(T.a.mark((function e(){var t,n,a,r,c,i;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.adapter,a=t.setEditor,r=t.dispatch,e.next=3,n.getFields();case 3:return c=e.sent,e.next=6,n.getLayers();case 6:i=e.sent,a({layers:i,fields:c}),r({type:F.DATA_FLOW_DATA_READY});case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return v.a.createElement(he,null,v.a.createElement(re,null),v.a.createElement(de,null),v.a.createElement(pe,null))}}]),t}(v.a.Component),ve=Object(j.b)((function(e){return{editor:e.editor}}),(function(e){return{dispatch:e,setEditor:function(t){return e(_(t))},setTheme:function(t){return e(k(t))}}}))(ge),be=n(26),me=n(140),Oe=n(144),ye=n(141),we=n(14),je=T.a.mark(_e),xe=T.a.mark(Ee);function _e(){var e,t;return T.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(we.d)();case 2:return e=n.sent,t=e.editor.widget.attributes.widgetConfig,n.next=6,Object(we.c)(H(t.paramsConfig));case 6:case"end":return n.stop()}}),je)}function Ee(){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(we.e)("EDITOR/setEditor",_e);case 2:case"end":return e.stop()}}),xe)}var ke=n(64),De=Object(x.createAction)("WIDGET/setWidget"),Ae={setWidget:De},Te=T.a.mark(Ie),Se=T.a.mark(Pe),Ce=T.a.mark(Ne);function Ie(){var e,t,n,a,r,c,i;return T.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,Object(we.d)();case 2:return e=o.sent,t=e.editor,n=e.configuration,a=t.widgetData,r=t.widget.attributes.widgetConfig,c=new ke.WidgetHelper(r,a,n),i=c.getVegaConfig(),o.next=11,Object(we.c)(De(i));case 11:case"end":return o.stop()}}),Te)}function Pe(){var e,t,n,a,r,c,i;return T.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,Object(we.d)();case 2:return e=o.sent,t=e.editor,n=e.configuration,a=t.widgetData,r=t.widget.attributes.widgetConfig,c=new ke.WidgetHelper(r,a,n),i=c.getVegaConfig(),console.log("updating widget",i),o.next=12,Object(we.c)(De(i));case 12:case"end":return o.stop()}}),Se)}function Ne(){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(we.e)(F.DATA_FLOW_VISUALISATION_READY,Ie);case 2:return e.next=4,Object(we.e)("CONFIGURATION/patchConfiguration",Pe);case 4:case"end":return e.stop()}}),Ce)}var We=T.a.mark(Le);function Le(){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(we.a)([Object(we.b)(Ee),Object(we.b)(Ne)]);case 2:case"end":return e.stop()}}),We)}var Re=n(3);function Me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var Fe=Object(Re.a)({},_,(function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Me(Object(n),!0).forEach((function(t){Object(Re.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{},t.payload)})),Ge={dataset:null,widget:null,widgetData:null};function Ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var Ve=Object(Re.a)({},k,(function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(n),!0).forEach((function(t){Object(Re.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{},t.payload)})),ze={color:"#C32D7B"};function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var Ye,He=Object(Re.a)({},De,(function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(n),!0).forEach((function(t){Object(Re.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{},t.payload)})),Ke={};function qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(n),!0).forEach((function(t){Object(Re.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Je=(Ye={},Object(Re.a)(Ye,H,(function(e,t){return Qe({},e,{},t.payload)})),Object(Re.a)(Ye,K,(function(e,t){return Qe({},e,{},t.payload)})),Ye),$e={visualizationType:"chart",chartType:"pie",availableCharts:[{value:"pie",label:"pie"},{value:"bars",label:"Bars"}]},Xe=Object(Oe.a)(),Ze=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(be.combineReducers)({configuration:Object(x.handleModule)(h),editor:Object(x.handleModule)(s),theme:Object(x.handleModule)(l),widget:Object(x.handleModule)(f)}),n=Object(be.applyMiddleware)(ye.a,Xe),a=Object(me.composeWithDevTools)(n),r=Object(be.createStore)(t,e,a);return Xe.run(Le),{store:r}},et=function(e){var t=e.adapter,n=e.theme,a=Ze().store;return"undefined"===typeof t&&console.error("WidgetEditor requires a prop: adapter"),v.a.createElement(j.a,{store:a},v.a.createElement(ve,{adapter:t,theme:n}))},tt=n(142);var nt=function(){var e=Object(g.useState)(!1),t=Object(O.a)(e,2),n=t[0],a=t[1],r=Object(g.useState)({color:"#C32D7B"}),c=Object(O.a)(r,2),i=c[0],o=c[1],s=new w.a({applications:["rw"],env:"production",locale:"en",includes:["metadata","vocabulary","widget","layer"]},"a86d906d-9862-4783-9e30-cdb68cd808b8");return v.a.createElement("div",{className:"App"},v.a.createElement("header",{className:"App-header"},"Widget editor V2",v.a.createElement("div",{className:"App-set-theme",onClick:function(){return a(!n)}},v.a.createElement("span",{className:"theme-preview",style:{background:i.color}}),v.a.createElement("h4",null,"Test Theme"),n&&v.a.createElement(tt.GithubPicker,{onChangeComplete:function(e){o({color:e.hex})},theme:"Github"}))),v.a.createElement("div",{className:"widget-editor-wrapper"},v.a.createElement(et,{adapter:s,theme:i})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));m.a.render(v.a.createElement(nt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},64:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(159));t.DatasetService=r.default;var c=a(n(160));t.WidgetService=c.default;var i=a(n(161));t.WidgetHelper=i.default;var o=a(n(95));t.getQueryByFilters=o.default},95:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"asc",i=n.map((function(e){if(null===e.value||void 0===e.value)return null;if("string"===e.type){var n;switch(e.operation){case"contains":n="".concat(e.name," LIKE '%").concat(e.value,"%'");break;case"not-contain":n="".concat(e.name," NOT LIKE '%").concat(e.value,"%'");break;case"starts-with":n="".concat(e.name," LIKE '").concat(e.value,"%'");break;case"ends-with":n="".concat(e.name," LIKE '%").concat(e.value,"'");break;case"=":n="".concat(e.name," LIKE '").concat(e.value,"'");break;case"!=":n="".concat(e.name," NOT LIKE '").concat(e.value,"'");break;case"by-values":default:n="".concat(e.name," IN ('").concat(e.value.join("', '"),"')")}return e.notNull?"".concat(n," AND ").concat(e.name," IS NOT NULL"):n}if("number"===e.type){var a;switch(e.operation){case"not-between":a="".concat(e.name," < ").concat(e.value[0]," OR ").concat(e.name," > ").concat(e.value[1]);break;case">":a="".concat(e.name," > ").concat(e.value);break;case">=":a="".concat(e.name," >= ").concat(e.value);break;case"<":a="".concat(e.name," < ").concat(e.value);break;case"<=":a="".concat(e.name," <= ").concat(e.value);break;case"=":a="".concat(e.name," = ").concat(e.value);break;case"!=":a="".concat(e.name," <> ").concat(e.value);break;case"between":default:a="".concat(e.name," >= ").concat(e.value[0]," AND ").concat(e.name," <= ").concat(e.value[1])}return e.notNull?"".concat(a," AND ").concat(e.name," IS NOT NULL"):a}if("date"===e.type){var r,c=function(e){return"featureservice"===t?"date '".concat(e.split("T")[0],"'"):"'".concat(e,"'")};switch(e.operation){case"not-between":r="".concat(e.name," < ").concat(c(e.value[0])," OR ").concat(e.name," > ").concat(c(e.value[1]));break;case">":r="".concat(e.name," > ").concat(c(e.value));break;case">=":r="".concat(e.name," >= ").concat(c(e.value));break;case"<":r="".concat(e.name," < ").concat(c(e.value));break;case"<=":r="".concat(e.name," <= ").concat(c(e.value));break;case"=":r="".concat(e.name," = ").concat(c(e.value));break;case"!=":r="".concat(e.name," <> ").concat(c(e.value));break;case"between":default:r="".concat(e.name," >= ").concat(c(e.value[0])," AND ").concat(e.name," <= ").concat(c(e.value[1]))}return e.notNull?"".concat(r," AND ").concat(e.name," IS NOT NULL"):r}return null})).filter((function(e){return!!e})).join(" AND "),o="*";a.length&&(o=a.map((function(e){var t="".concat(e.value);return e.aggregateFunction&&(t="".concat(e.aggregateFunction.toUpperCase(),"(").concat(t,")")),e.as&&(t="".concat(t," as ").concat(e.key)),t})).join(", "));var s="";if(r.length){var u=r.map((function(e){return e.name})).join(" ");s="ORDER BY ".concat(u," ").concat(c)}var l=i.length?"WHERE ".concat(i):"",d=a.filter((function(e){return e.group})),f="GROUP BY ";return d.forEach((function(e){f="".concat(f," ").concat(e.key,",")})),f=0===d.length?"":f.slice(0,-1),encodeURIComponent("SELECT ".concat(o," FROM ").concat(e," ").concat(l," ").concat(f," ").concat(s))}}},[[151,1,2]]]);
//# sourceMappingURL=main.89190fa0.chunk.js.map