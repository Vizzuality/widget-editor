(this["webpackJsonp@applications/widget-editor"]=this["webpackJsonp@applications/widget-editor"]||[]).push([[0],{139:function(e,t,n){"use strict";var a=n(6),i=n(24),r=n(25),o=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function o(e){try{s(a.next(e))}catch(t){r(t)}}function c(e){try{s(a.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}s((a=a.apply(e,t||[])).next())}))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(21),l=c(n(273)),u=function(){function e(){i(this,e),this.endpoint="https://api.resourcewatch.org/v1",this.config=null,this.datasetService=null,this.widgetService=null,this.datasetId=null,this.AUTH_TOKEN=null,this.applications=["rw"],this.env="production",this.locale="en",this.widget_params=["chartType","visualizationType","limit","value","category","color","size","orderBy","aggregateFunction","filters","areaIntersection","band","layer"];var t={applications:this.applications,env:this.env,locale:this.locale};this.config=l.default(t),this.datasetService=new s.DatasetService(this.config),this.widgetService=new s.WidgetService(this.config)}return r(e,[{key:"payload",value:function(){return{applications:this.applications,env:this.env}}},{key:"saveWidgetRW",value:function(){return o(this,void 0,void 0,a.mark((function e(){var t,n;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="".concat(this.endpoint,"/dataset/").concat(this.datasetId,"/widget"),!this.AUTH_TOKEN){e.next=16;break}return e.prev=2,e.next=5,fetch(t,{method:"POST",headers:{Authorization:"Bearer ".concat(this.AUTH_TOKEN)}});case 5:return n=e.sent,e.next=8,n.json();case 8:return e.abrupt("return",e.sent);case 11:e.prev=11,e.t0=e.catch(2),console.error("Cant save widget",e.t0);case 14:e.next=17;break;case 16:console.error("Missing auth token for saveWidget (RW)");case 17:case"end":return e.stop()}}),e,this,[[2,11]])})))}},{key:"hasAuthToken",value:function(){return!!this.AUTH_TOKEN}},{key:"setDatasetId",value:function(e){e||console.error("Error: datasetId is required"),this.datasetId=e}},{key:"getDataset",value:function(){return o(this,void 0,void 0,a.mark((function e(){var t,n,i,r,o,c,s;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.config.getConfig(),n=t.applications,i=t.env,r=t.locale,"metadata,vocabulary,widget,layer",o="".concat(this.endpoint,"/dataset/").concat(this.datasetId,"?").concat(n.join(","),"&env=").concat(i,"&language=").concat(r,"&includes=").concat("metadata,vocabulary,widget,layer","&page[size]=999"),e.next=5,this.datasetService.fetchData(o);case 5:return c=e.sent,s=c.data,e.abrupt("return",s);case 8:case"end":return e.stop()}}),e,this)})))}},{key:"getFields",value:function(){return o(this,void 0,void 0,a.mark((function e(){var t,n,i;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(this.endpoint,"/fields/").concat(this.datasetId),e.next=3,this.datasetService.fetchData(t);case 3:return n=e.sent,i=n.fields,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"getWidget",value:function(e){return o(this,void 0,void 0,a.mark((function t(){var n,i,r,o,c,s,l,u;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.config.getConfig(),i=n.applications,r=n.env,o=n.locale,"metadata",c=this.widgetService.fromDataset(e).id,s="".concat(this.endpoint,"/widget/").concat(c,"?").concat(i.join(","),"&env=").concat(r,"&language=").concat(o,"&includes=").concat("metadata","&page[size]=999"),t.next=6,this.widgetService.fetchWidget(s);case 6:return l=t.sent,u=l.data,t.abrupt("return",u);case 9:case"end":return t.stop()}}),t,this)})))}},{key:"getWidgetData",value:function(e,t){return o(this,void 0,void 0,a.mark((function n(){var i,r,o,c;return a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=this.widgetService.getDataSqlQuery(e,t),r="".concat(this.endpoint,"/query/").concat(this.datasetId,"?sql=").concat(i),n.next=4,this.widgetService.fetchWidgetData(r);case 4:return o=n.sent,c=o.data,n.abrupt("return",c);case 7:case"end":return n.stop()}}),n,this)})))}},{key:"getLayers",value:function(){return o(this,void 0,void 0,a.mark((function e(){var t,n,i,r,o,c;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.config.getConfig(),n=t.applications,i=t.env,t.locale,r="".concat(this.endpoint,"/dataset/").concat(this.datasetId,"/layer?app=").concat(n.join(","),"&env=").concat(i,"&page[size]=9999"),e.next=4,this.datasetService.fetchData(r);case 4:return o=e.sent,c=o.data,e.abrupt("return",c);case 7:case"end":return e.stop()}}),e,this)})))}},{key:"handleFilters",value:function(e){if(!e||!Array.isArray(e)||0===e.length)return[];var t=[];return e.forEach((function(e,n){var a;"date"===e.type&&(a=Array.isArray(e.value)?2===e.value.length?[new Date(e.value[0]).getFullYear(),new Date(e.value[1]).getFullYear()]:[new Date(e.value[0]).getFullYear()]:new Date(e.value).getFullYear(),t.push(s.FiltersService.baseFilter(a,e.name,e.type,n)));"number"===e.type&&t.push(s.FiltersService.baseFilter(e.value,e.name,e.type,n))})),console.log("Filters we got",e),t}}]),e}();t.default=u},149:function(e,t,n){e.exports=n(276)},154:function(e,t,n){},159:function(e,t,n){"use strict";var a=n(6),i=n(24),r=n(25),o=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function o(e){try{s(a.next(e))}catch(t){r(t)}}function c(e){try{s(a.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}s((a=a.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(t){i(this,e),this.config=t}return r(e,[{key:"fetchData",value:function(e){return o(this,void 0,void 0,a.mark((function t(){var n;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(e);case 3:if(!((n=t.sent).status>=400)){t.next=6;break}throw new Error(n.statusText);case 6:return t.next=8,n.json();case 8:return t.abrupt("return",t.sent);case 11:throw t.prev=11,t.t0=t.catch(0),new Error(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))}}]),e}();t.default=c},161:function(e,t,n){"use strict";var a=n(6),i=n(24),r=n(25),o=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function o(e){try{s(a.next(e))}catch(t){r(t)}}function c(e){try{s(a.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}s((a=a.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var c=n(96),s=function(){function e(t){i(this,e),this.config=t}return r(e,[{key:"fromDataset",value:function(e){return c.find(e.attributes.widget,(function(e){return!!e.attributes.defaultEditableWidget}))}},{key:"getDataSqlQuery",value:function(e,t){return""}},{key:"fetchWidgetData",value:function(e){return o(this,void 0,void 0,a.mark((function e(){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 1:case"end":return e.stop()}}),e)})))}},{key:"fetchWidget",value:function(e){return o(this,void 0,void 0,a.mark((function t(){var n;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(e);case 3:if(!((n=t.sent).status>=400)){t.next=6;break}throw new Error(n.statusText);case 6:return t.next=8,n.json();case 8:return t.abrupt("return",t.sent);case 11:throw t.prev=11,t.t0=t.catch(0),new Error(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))}}]),e}();t.default=s},162:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return"string"!==typeof e?"":e.charAt(0).toUpperCase()+e.slice(1)}},163:function(e,t,n){"use strict";var a=n(6),i=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function o(e){try{s(a.next(e))}catch(t){r(t)}}function c(e){try{s(a.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}s((a=a.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});t.TYPE_FILTER_ON_VALUES="FILTER_ON_VALUES",t.TYPE_TEXT_CONTAINS="TEXT_CONTAINS",t.TYPE_TEXT_NOT_CONTAINS="TEXT_NOT_CONTAINS",t.TYPE_TEXT_STARTS_WITH="TEXT_STARTS_WITH",t.TYPE_TEXT_ENDS_WITH="TEXT_ENDS_WITH";var r={values:"",type:null,notNull:!1},o={values:[0,100],type:"range",notNull:!0,max:500,min:0},c={values:0,type:"value",notNull:!0,max:500,min:0};function s(e,t){return i(this,void 0,void 0,a.mark((function n(){var i;return a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=0;case 1:if(!(i<e.length)){n.next=7;break}return n.next=4,t(e[i],i,e);case 4:i++,n.next=1;break;case 7:case"end":return n.stop()}}),n)})))}var l=function(e,t,n){return i(void 0,void 0,void 0,a.mark((function i(){var r,o,c;return a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=t.values,t.type,a.next=3,n.getFieldInfo(e,r.value);case 3:return o=a.sent,c="string"!==r.dataType?Object.assign(Object.assign({},e.filter),{values:[o.min,o.max]}):Object.assign(Object.assign({},e.filter),{type:"string",values:[]}),a.abrupt("return",Object.assign(Object.assign({},e),{column:r.value,indicator:"string"===r.dataType?"FILTER_ON_VALUES":"range",dataType:r.dataType,fieldInfo:o,filter:c}));case 6:case"end":return a.stop()}}),i)})))},u=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?Array.isArray(e)?e:[]:null===e?"":Array.isArray(e)?e.map((function(e){return e.label})).join(","):e},d=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=e.fieldInfo&&e.fieldInfo.min?e.fieldInfo.min:0,i=e.fieldInfo&&e.fieldInfo.max?e.fieldInfo.max:0;return t||(n?[a,i]:i)},p=function(e,n){var a=n.values,i=e.filter.values,s=null;if(a.value===t.TYPE_FILTER_ON_VALUES)s=Object.assign(Object.assign({},r),{notNull:!0,values:u(i,!0)});else if(a.value===t.TYPE_TEXT_CONTAINS||a.value===t.TYPE_TEXT_NOT_CONTAINS||a.value===t.TYPE_TEXT_STARTS_WITH||a.value===t.TYPE_TEXT_ENDS_WITH)s=Object.assign(Object.assign({},r),{values:u(i)});else if("range"===a.value)s=Object.assign(Object.assign({},o),{values:d(e,i,!0)});else{if("value"!==a.value)throw new Error("Filters helper patch indicator, type ".concat(a.value," is not a valid indicator."));s=Object.assign(Object.assign({},c),{values:d(e,i)})}return Object.assign(Object.assign({},e),{indicator:a.value,filter:s})},f=function(e,t){var n=t.values;return Object.assign(Object.assign({},e),{filter:Object.assign(Object.assign({},e.filter),{values:n})})},h=function(e,t){var n=t.values;return Object.assign(Object.assign({},e),{filter:Object.assign(Object.assign({},e.filter),{values:n})})},g=function(e){return Object.assign(Object.assign({},e),{filter:Object.assign(Object.assign({},e.filter),{notNull:!e.filter.notNull})})};t.default=function(e,n,r){return i(void 0,void 0,void 0,a.mark((function o(){var c,u,d;return a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(r.values,c=r.id,u=r.type,d=[],"columns"!==u){o.next=7;break}return o.next=5,s(e,(function(e){return i(void 0,void 0,void 0,a.mark((function t(){var i;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.id!==c){t.next=7;break}return t.next=3,l(e,r,n);case 3:i=t.sent,d.push(i),t.next=8;break;case 7:d.push(e);case 8:case"end":return t.stop()}}),t)})))}));case 5:o.next=8;break;case 7:d=e.map((function(e){if(e.id===c){if("indicator"===u)return p(e,r);if("range"===u)return f(e,r);if("value"===u||u===t.TYPE_FILTER_ON_VALUES)return h(e,r);if("NOT_NULL_CHECK"===u)return g(e);throw new Error("Error in filter helper type ".concat(u," not implemented."))}return e}));case 8:return o.abrupt("return",d);case 9:case"end":return o.stop()}}),o)})))}},164:function(e,t,n){"use strict";var a=n(165),i=n(6),r=n(24),o=n(25),c=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function o(e){try{s(a.next(e))}catch(t){r(t)}}function c(e){try{s(a.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}s((a=a.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=s(n(75)),u=n(98),d=function(){function e(t,n,a,i){r(this,e),this.adapter=n,this.setEditor=a,this.dispatch=i,this.dataset=null,this.widget=null,this.widgetData=null,this.adapter.setDatasetId(t)}return o(e,[{key:"getDatasetAndWidgets",value:function(){return c(this,void 0,void 0,i.mark((function e(){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.adapter.getDataset();case 2:return this.dataset=e.sent,e.next=5,this.adapter.getWidget(this.dataset);case 5:return this.widget=e.sent,e.next=8,this.translateFilters();case 8:this.setEditor({dataset:this.dataset,widget:this.widget}),this.dispatch({type:u.sagaEvents.DATA_FLOW_DATASET_WIDGET_READY});case 10:case"end":return e.stop()}}),e,this)})))}},{key:"restoreEditor",value:function(e){return c(this,void 0,void 0,i.mark((function t(){return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setEditor({restoring:!0}),this.adapter.setDatasetId(e),t.next=4,this.getDatasetAndWidgets();case 4:return t.next=6,this.getFieldsAndLayers();case 6:return t.next=8,this.getWidgetData();case 8:this.setEditor({restoring:!1});case 9:case"end":return t.stop()}}),t,this)})))}},{key:"translateFilters",value:function(){return c(this,void 0,void 0,i.mark((function e(){var t;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.widget.attributes.widgetConfig.paramsConfig.filters,this.dispatch({type:u.reduxActions.EDITOR_SET_FILTERS,payload:{list:this.adapter.handleFilters(t)}});case 2:case"end":return e.stop()}}),e,this)})))}},{key:"getWidgetData",value:function(){return c(this,void 0,void 0,i.mark((function e(){var t,n;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.widget.attributes.widgetConfig.paramsConfig,n=new l.default(t,this.dataset.id),e.prev=2,e.next=5,n.requestWidgetData();case 5:this.widgetData=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),this.setEditor({errors:["WIDGET_DATA_UNAVAILABLE"]});case 11:this.widgetData&&this.widgetData.data?(this.setEditor({widgetData:this.widgetData.data}),this.dispatch({type:u.sagaEvents.DATA_FLOW_WIDGET_DATA_READY})):this.setEditor({errors:["WIDGET_DATA_UNAVAILABLE"]});case 12:case"end":return e.stop()}}),e,this,[[2,8]])})))}},{key:"isFieldAllowed",value:function(e){var t=u.ALLOWED_FIELD_TYPES.find((function(t){return t.name.toLowerCase()===e.type.toLowerCase()}));return!("cartodb_id"===e.columnName)&&t}},{key:"getFieldsAndLayers",value:function(){return c(this,void 0,void 0,i.mark((function e(){var t,n,a,r,o=this;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.adapter.getFields();case 2:return t=e.sent,e.next=5,this.adapter.getLayers();case 5:n=e.sent,a=this.dataset.attributes.metadata[0].attributes.columns,r=[],Object.keys(t).forEach((function(e){var n=Object.assign(Object.assign({},t[e]),{columnName:e,metadata:a[e]});o.isFieldAllowed(n)&&r.push(n)})),this.setEditor({layers:n,fields:r}),this.dispatch({type:u.sagaEvents.DATA_FLOW_DATA_READY});case 11:case"end":return e.stop()}}),e,this)})))}},{key:"resolveUpdates",value:function(e,t){var n={};return this.adapter.widget_params.forEach((function(t){t in e?n=Object.assign(Object.assign({},n),a({},t,e[t])):console.warn("Widget Editor: Param(".concat(t,") does not exsist in widget, make sure adapter.widget_params has fields that match with your API widget payload. Refer to documentation for adapter.widget_params for aditional information."))})),Object.assign(Object.assign({},this.adapter.payload()),{title:e.title||null,description:e.description||null,widget:{params:n,data:t.data||null,scales:t.scales||null,axes:t.axes||null,marks:t.marks||null,interaction_config:t.interaction_config||null,config:t.config||null}})}},{key:"resolveInitialState",value:function(){return c(this,void 0,void 0,i.mark((function e(){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDatasetAndWidgets();case 2:return e.next=4,this.getWidgetData();case 4:return e.next=6,this.getFieldsAndLayers();case 6:this.setEditor({initialized:!0});case 7:case"end":return e.stop()}}),e,this)})))}}]),e}();t.default=d},166:function(e,t,n){"use strict";var a=n(24),i=n(25),r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(167)),c=r(n(168)),s=r(n(169)),l=r(n(170)),u=n(171),d=n(46),p=function(){function e(t,n,i){a(this,e),this.schema=d.defaultVegaSchema(),this.widgetConfig=t,this.widgetData=n,this.configuration=i,this.setConfig(),this.resolveChart()}return i(e,[{key:"resolveChart",value:function(){var e,t=this.configuration.chartType;if(-1===u.SUPPORTED_CHARTS.indexOf(t))throw new Error("Chart of type: ".concat(t," is not supported. we support: (").concat(u.SUPPORTED_CHARTS.join("|"),")"));"pie"===t&&(e=new o.default(this.schema,this.widgetConfig,this.widgetData).getChart()),"bar"===t&&(e=new c.default(this.schema,this.widgetConfig,this.widgetData).getChart()),"line"===t&&(e=new s.default(this.schema,this.widgetConfig,this.widgetData).getChart()),"scatter"===t&&(e=new l.default(this.schema,this.widgetConfig,this.widgetData).getChart()),this.schema=Object.assign(Object.assign({},this.schema),e)}},{key:"setConfig",value:function(){this.schema=Object.assign(Object.assign({},this.schema),{config:this.widgetConfig.config})}},{key:"getChart",value:function(){return this.schema}}]),e}();t.default=p},167:function(e,t,n){"use strict";var a=n(24),i=n(25);Object.defineProperty(t,"__esModule",{value:!0});var r=n(46),o=function(){function e(t,n,i){a(this,e),this.schema=t,this.widgetConfig=n,this.widgetData=i,this.generateSchema(),this.setGenericSettings()}return i(e,[{key:"generateSchema",value:function(){this.schema=Object.assign(Object.assign({},this.schema),{scales:this.setScales(),marks:this.setMarks(),data:this.bindData(),interaction_config:this.interactionConfig()})}},{key:"setGenericSettings",value:function(){this.schema=Object.assign(Object.assign({},this.schema),{width:400,height:400})}},{key:"interactionConfig",value:function(){return[{name:"tooltip",config:{fields:[{column:"y",property:"y",type:"number",format:".2s"},{column:"x",property:"x",type:"string",format:".2f"}]}}]}},{key:"setScales",value:function(){return[{name:"c",type:"ordinal",domain:{data:"table",field:r.sqlFields.value},range:{scheme:"category20"}}]}},{key:"setMarks",value:function(){return[{type:"arc",from:{data:"table"},encode:{enter:{tooltip:{signal:"{'Label': datum.x, 'Value': datum.y }"},fill:{scale:"c",field:r.sqlFields.value},x:{signal:"width / 2"},y:{signal:"height / 2"}},update:{startAngle:{field:"startAngle"},endAngle:{field:"endAngle"},innerRadius:{signal:"width > height ? height / 3 : width / 3"},outerRadius:{signal:"width > height ? height / 2 : width / 2"}},hover:{opacity:{value:.8}}}}]}},{key:"bindData",value:function(){return[{values:this.widgetData,name:"table",transform:[{type:"pie",field:r.sqlFields.category,startAngle:0,endAngle:6.29}]}]}},{key:"getChart",value:function(){return this.schema}}]),e}();t.default=o},168:function(e,t,n){"use strict";var a=n(24),i=n(25);Object.defineProperty(t,"__esModule",{value:!0});var r=n(46),o=function(){function e(t,n,i){a(this,e),this.schema=t,this.widgetConfig=n,this.widgetData=i,this.generateSchema(),this.setGenericSettings()}return i(e,[{key:"generateSchema",value:function(){this.schema=Object.assign(Object.assign({},this.schema),{axes:this.setAxes(),scales:this.setScales(),marks:this.setMarks(),data:this.bindData(),interaction_config:this.interactionConfig()})}},{key:"setGenericSettings",value:function(){this.schema=Object.assign(Object.assign({},this.schema),{height:400,autosize:{type:"fit",contains:"padding"},padding:20})}},{key:"setScales",value:function(){return[{name:"x",type:"band",domain:{data:"table",field:"id"},range:"width",padding:.05},{name:"y",type:"linear",domain:{data:"table",field:r.sqlFields.category},nice:!0,zero:!0,range:"height"}]}},{key:"setMarks",value:function(){return[{type:"rect",from:{data:"table"},encode:{enter:{tooltip:{signal:"{'Label': datum.x, 'Value': datum.y }"}},update:{opacity:{value:1},x:{scale:"x",field:"id"},width:{scale:"x",band:1},y:{scale:"y",field:"y"},y2:{scale:"y",value:0}},hover:{opacity:{value:.8}}}}]}},{key:"interactionConfig",value:function(){return[{name:"tooltip",config:{fields:[{column:"y",property:"y",type:"number",format:".2s"},{column:"x",property:"x",type:"string",format:".2f"}]}}]}},{key:"setAxes",value:function(){return[Object.assign(Object.assign(Object.assign({},this.schema.axis),this.schema.axisX),{orient:"bottom",scale:"x",labelOverlap:"parity",ticks:!1,encode:{labels:{update:{text:{signal:"width < 300 || data('table')[0].count > 10 ? truncate(data('table')[datum.value - 1].x, 12) : data('table')[datum.value - 1].x"},align:{signal:"width < 300 || data('table')[0].count > 10 ? 'right' : 'center'"},baseline:{signal:"width < 300 || data('table')[0].count > 10 ? 'middle' : 'top'"},angle:{signal:"width < 300 || data('table')[0].count > 10 ? -90 : 0"}}}}}),Object.assign(Object.assign(Object.assign({},this.schema.axis),this.schema.axisY),{orient:"left",scale:"y",labelOverlap:"parity",format:"s",encode:{labels:{update:{align:{value:"right"},baseline:{value:"bottom"}}}}})]}},{key:"bindData",value:function(){return[{values:this.widgetData,name:"table",transform:[{type:"identifier",as:"id"},{type:"joinaggregate",as:["count"]}]}]}},{key:"getChart",value:function(){return this.schema}}]),e}();t.default=o},169:function(e,t,n){"use strict";var a=n(24),i=n(25);Object.defineProperty(t,"__esModule",{value:!0});var r=n(46),o=function(){function e(t,n,i){a(this,e),this.schema=t,this.widgetConfig=n,this.widgetData=i,this.generateSchema(),this.setGenericSettings()}return i(e,[{key:"generateSchema",value:function(){this.schema=Object.assign(Object.assign({},this.schema),{axes:this.setAxes(),scales:this.setScales(),marks:this.setMarks(),data:this.bindData(),interaction_config:this.interactionConfig(),signals:[{name:"hover",value:null,on:[{events:"@cell:mouseover",update:"datum"},{events:"@cell:mouseout",update:"null"}]}]})}},{key:"setGenericSettings",value:function(){this.schema=Object.assign(Object.assign({},this.schema),{height:400,autosize:{type:"fit",contains:"padding"},padding:20})}},{key:"interactionConfig",value:function(){return[{name:"tooltip",config:{fields:[{column:"y",property:"y",type:"number",format:".2s"},{column:"x",property:"x",type:"string"}]}}]}},{key:"setScales",value:function(){return[{name:"x",type:"point",range:"width",domain:{data:"table",field:"x"}},{name:"y",type:"linear",range:"height",nice:!0,zero:!0,domain:{data:"table",field:r.sqlFields.category}}]}},{key:"setMarks",value:function(){return[{name:"lines",interactive:!1,type:"line",from:{data:"table"},encode:{enter:{x:{scale:"x",field:"x"},y:{scale:"y",field:"y"},strokeCap:{value:"round"},strokeWidth:{value:2},strokeJoin:{value:"round"}}}},{name:"points",interactive:!1,type:"symbol",from:{data:"dots"},encode:{enter:{x:{scale:"x",field:"x"},y:{scale:"y",field:"y"}},update:{opacity:{value:1}}}},{name:"cell",type:"path",from:{data:"lines"},transform:[{type:"voronoi",x:"datum.x",y:"datum.y",size:[{signal:"width"},{signal:"height"}]}],encode:{enter:{tooltip:{signal:"{'Value': datum.x }"}},update:{path:{field:"path"},fill:{value:"red"},opacity:{value:0}}}}]}},{key:"setAxes",value:function(){return[Object.assign(Object.assign(Object.assign({},this.schema.axis),this.schema.axisX),{orient:"bottom",scale:"x",labelOverlap:"parity",ticks:!1}),Object.assign(Object.assign(Object.assign({},this.schema.axis),this.schema.axisY),{orient:"left",scale:"y",labelOverlap:"parity",format:"s",encode:{labels:{update:{align:{value:"right"},baseline:{value:"bottom"}}}}})]}},{key:"bindData",value:function(){return[{values:this.widgetData,name:"table",transform:[{type:"identifier",as:"id"},{type:"joinaggregate",as:["count"]}]},{name:"dots",source:"table",transform:[{type:"filter",expr:"hover && hover.datum.x === datum.x"}]}]}},{key:"getChart",value:function(){return this.schema}}]),e}();t.default=o},170:function(e,t,n){"use strict";var a=n(24),i=n(25);Object.defineProperty(t,"__esModule",{value:!0});var r=n(46),o=function(){function e(t,n,i){a(this,e),this.schema=t,this.widgetConfig=n,this.widgetData=i,this.generateSchema(),this.setGenericSettings()}return i(e,[{key:"generateSchema",value:function(){this.schema=Object.assign(Object.assign({},this.schema),{axes:this.setAxes(),scales:this.setScales(),marks:this.setMarks(),data:this.bindData()})}},{key:"setGenericSettings",value:function(){this.schema=Object.assign(Object.assign({},this.schema),{height:300,autosize:{type:"fit",contains:"padding"},padding:20})}},{key:"setScales",value:function(){return[{name:"xscale",type:"linear",round:!0,nice:!0,zero:!1,domain:{data:"table",field:r.sqlFields.value},range:"width"},{name:"yscale",type:"linear",round:!0,nice:!0,zero:!0,domain:{data:"table",field:r.sqlFields.category},range:"height"}]}},{key:"setMarks",value:function(){return[{name:"marks",type:"symbol",from:{data:"table"},encode:{update:{x:{scale:"xscale",field:"x"},y:{scale:"yscale",field:"y"},strokeOpacity:{value:0},zindex:{value:0},opacity:{value:.5}},hover:{strokeOpacity:{value:1},zindex:{value:1},opacity:{value:1}}}}]}},{key:"setAxes",value:function(){return[{scale:"xscale",labelOverlap:"parity",orient:"bottom",encode:{labels:{update:{align:{value:"center"},baseline:{value:"top"}}}}},{scale:"yscale",labelOverlap:"parity",orient:"left",format:"s"}]}},{key:"bindData",value:function(){return[{values:this.widgetData,name:"table"}]}},{key:"getChart",value:function(){return this.schema}}]),e}();t.default=o},171:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SUPPORTED_CHARTS=["pie","bar","line","scatter"],t.default={SUPPORTED_CHARTS:t.SUPPORTED_CHARTS}},172:function(e,t,n){"use strict";var a=n(6),i=n(24),r=n(25),o=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function o(e){try{s(a.next(e))}catch(t){r(t)}}function c(e){try{s(a.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}s((a=a.apply(e,t||[])).next())}))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=c(n(75)),l=c(n(32)),u=function(){function e(){i(this,e),this.cache={limit:null,chartType:null,value:null,orderBy:null}}return r(e,[{key:"checkHasUpdate",value:function(e){var t=this,n=Object.keys(this.cache),a=!1;return n.forEach((function(n){a=a||!l.default(t.cache[n],e[n])})),a}},{key:"cacheCurrent",value:function(e){this.cache=e}},{key:"sync",value:function(e,t){return o(this,void 0,void 0,a.mark((function n(){var i,r,o;return a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(i=this.checkHasUpdate(e))){n.next=8;break}return this.cacheCurrent(e),r=new s.default(e,t),n.next=6,r.requestWidgetData();case 6:return o=n.sent,n.abrupt("return",{hasUpdates:i,widgetData:o.data});case 8:return n.abrupt("return",{hasUpdates:i,widgetData:null});case 9:case"end":return n.stop()}}),n,this)})))}}]),e}();t.default=u},21:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(159));t.DatasetService=i.default;var r=a(n(161));t.WidgetService=r.default;var o=a(n(75));t.FiltersService=o.default;var c=a(n(164));t.DataService=c.default;var s=a(n(166));t.VegaService=s.default;var l=a(n(97));t.FieldsService=l.default;var u=a(n(172));t.StateProxy=u.default;var d=a(n(98));t.constants=d.default},273:function(e,t,n){"use strict";var a=n(24),i=n(25);Object.defineProperty(t,"__esModule",{value:!0});var r=n(96),o=function(){function e(t){a(this,e),this.setConfig(t)}return i(e,[{key:"setConfig",value:function(e){var t=r.pick(e,["url","env","applications","authUrl","assetsPath","userToken","userEmail","locale"]);this.config=Object.assign(Object.assign({},this.config),t)}},{key:"getConfig",value:function(){return this.config}}]),e}();t.default=function(e){return new o(e)}},274:function(e,t,n){},275:function(e,t,n){},276:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"setEditor",(function(){return z})),n.d(a,"default",(function(){return W}));var i={};n.r(i),n.d(i,"setTheme",(function(){return q})),n.d(i,"default",(function(){return B}));var r={};n.r(r),n.d(r,"setConfiguration",(function(){return ae})),n.d(r,"patchConfiguration",(function(){return ie})),n.d(r,"saveConfiguration",(function(){return re})),n.d(r,"default",(function(){return oe}));var o={};n.r(o),n.d(o,"setFilters",(function(){return Yt})),n.d(o,"default",(function(){return Vt}));var c={};n.r(c),n.d(c,"default",(function(){return Qn}));var s={};n.r(s),n.d(s,"actions",(function(){return a})),n.d(s,"initialState",(function(){return Zn})),n.d(s,"reducers",(function(){return c}));var l={};n.r(l),n.d(l,"default",(function(){return $n}));var u={};n.r(u),n.d(u,"actions",(function(){return i})),n.d(u,"initialState",(function(){return ea})),n.d(u,"reducers",(function(){return l}));var d={};n.r(d),n.d(d,"setWidget",(function(){return ta})),n.d(d,"default",(function(){return na}));var p={};n.r(p),n.d(p,"default",(function(){return aa}));var f={};n.r(f),n.d(f,"actions",(function(){return d})),n.d(f,"initialState",(function(){return ia})),n.d(f,"reducers",(function(){return p}));var h={};n.r(h),n.d(h,"default",(function(){return ra}));var g={};n.r(g),n.d(g,"actions",(function(){return r})),n.d(g,"initialState",(function(){return oa})),n.d(g,"reducers",(function(){return h}));var m={};n.r(m),n.d(m,"default",(function(){return ca}));var v={};n.r(v),n.d(v,"actions",(function(){return o})),n.d(v,"initialState",(function(){return sa})),n.d(v,"reducers",(function(){return m}));var b={};n.r(b),n.d(b,"modifyOptions",(function(){return Da})),n.d(b,"default",(function(){return Ia}));var y={};n.r(y),n.d(y,"default",(function(){return Na}));var x={};n.r(x),n.d(x,"actions",(function(){return b})),n.d(x,"initialState",(function(){return Fa})),n.d(x,"reducers",(function(){return y}));var w=n(1),E=n.n(w),O=n(29),_=n.n(O),C=(n(154),n(35)),A=n(10),k=n(31),S=n(126),j=n(11),T=n(9),D=n(14),I=n(15),N=n(16),F=n(27),P=n(21),M=function(e,t){return Object(C.b)((function(t){return"function"===typeof e?e(t[P.constants.APP_NAMESPACE]):{}}),t)},R=function(e){return Object(F.createAction)("".concat(P.constants.APP_NAMESPACE,"/").concat(e))},L=function(e){return"".concat(P.constants.APP_NAMESPACE,"/").concat(e)},z=R("EDITOR/setEditor"),W={setEditor:z},q=R("EDITOR/THEME/setTheme"),B={setTheme:q},U=n(3),Y=n(32),V=n.n(Y),G=n(48),H=n.n(G),X=n(94),K=n(140),J=n(5),Q=n(128),Z=n.n(Q),$=(n(129),J.c.div.withConfig({displayName:"component__StyledContainer",componentId:"p6fymh-0"})(["flex 1;display:flex;width:100%;.c-chart{flex:1;text-align:center;overflow:hidden;margin:20px;max-height:400px;align-self:center;}"])),ee=function(e,t){var n=function(e){if(!e||!e.interaction_config||!e.interaction_config.length)return[];var t=e.interaction_config.find((function(e){return"tooltip"===e.name}));return t&&t.config&&t.config.fields&&t.config.fields.length?t.config.fields:[]}(t);Object(K.a)(e,{showAllFields:!1,fields:n.map((function(e){var t=e.column,n=e.property,a=e.type;return{field:t,title:n,formatType:"date"===a?"time":a,format:e.format}}))})},te=function(e){var t=e.editor,n=e.widget,a=Object(w.useRef)(),i=Object(w.useRef)(),r=Object(w.useRef)();return Object(w.useEffect)((function(){if(a.current&&!Z()(n)&&!V()(n,r)){var e=X.b(n),t=a.current.offsetWidth;i.current=new X.a(e).initialize(a.current).renderer("canvas").width(t-40).hover().run(),r.current=n,i.current&&n.interaction_config&&n.interaction_config.length&&ee(i.current,n),i.current.resize=function(){var e=a.current.offsetWidth;i.current.width(e-40).run(),ee(i.current,n)},window.addEventListener("resize",i.current.resize)}}),[a,t,n]),E.a.createElement($,null,E.a.createElement("div",{className:"c-chart",ref:a}))},ne=M((function(e){return{editor:e.editor,widget:e.widget}}))(te),ae=R("CONFIGURATION/setConfiguration"),ie=R("CONFIGURATION/patchConfiguration"),re=R("CONFIGURATION/saveConfiguration"),oe={saveConfiguration:re,setConfiguration:ae,patchConfiguration:ie},ce=n(93),se=function(e){return e.editor.dataset},le=Object(ce.a)([function(e){return e.configuration},se],(function(e,t){var n=t.attributes.metadata[0].attributes.columns[e.value.name];return Object(A.a)({},n,{identifier:e.value.name})})),ue=Object(ce.a)([se],(function(e){return e.attributes.widgetRelevantProps.map((function(t){return Object(A.a)({},e.attributes.metadata[0].attributes.columns[t],{identifier:t})}))})),de=J.c.div.withConfig({displayName:"flex__FlexContainer",componentId:"sc-1jjiixp-0"})(["display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;flex-flow:",";width:100%;"," label{flex-basis:100%;}"],(function(e){return e.row?"row":"column"}),(function(e){return e.row?"> * { padding-right: 20px; &:last-child { padding-right: 0; } } ":""})),pe=n(12),fe=n(23),he=n(26),ge=function(){return E.a.createElement("svg",{width:"10px",height:"10px",viewBox:"0 0 10 10",version:"1.1"},E.a.createElement("g",{id:"Iteration",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},E.a.createElement("g",{id:"xAxis-Selector",transform:"translate(-183.000000, -311.000000)",fill:"#2C75B0"},E.a.createElement("g",{id:"Rectangle-409-+-364-+-MWh-Copy",transform:"translate(163.000000, 289.000000)"},E.a.createElement("g",{id:"Group-20",transform:"translate(19.000000, 10.000000)"},E.a.createElement("path",{d:"M4.5,12 L11,18.5 L7.5,22 L1,15.5 L1,12 L4.5,12 Z M3.5,13.5 C2.94771525,13.5 2.5,13.9477153 2.5,14.5 C2.5,15.0522847 2.94771525,15.5 3.5,15.5 C4.05228475,15.5 4.5,15.0522847 4.5,14.5 C4.5,13.9477153 4.05228475,13.5 3.5,13.5 Z",id:"item-category"}))))))},me=J.c.div.withConfig({displayName:"style__StyledPopupContainer",componentId:"eg9uyn-0"})(["position:absolute;box-sizing:border-box;height:auto;width:422px;border:1px solid rgba(26,28,34,0.1);border-radius:4px;background-color:#FFFFFF;box-shadow:0 20px 30px 0 rgba(0,0,0,0.1);z-index:2;bottom:40px;left:-75px;padding:20px;&:after{content:'';position:absolute;left:200px;bottom:-20px;border:10px solid transparent;border-top:10px solid #FFFFFF;z-index:3;}"]),ve=J.c.h4.withConfig({displayName:"style__StyledCategoryAlias",componentId:"eg9uyn-1"})(["position:relative;padding-left:20px;margin-bottom:10px;margin-top:0;color:#2C75B0;font-size:16px;line-height:25px;"]),be=J.c.div.withConfig({displayName:"style__StyledCategoryDescription",componentId:"eg9uyn-2"})(["position:relative;padding-left:20px;margin-top:10px;margin-bottom:10px;color:#393F44;font-size:16px;line-height:25px;"]),ye=J.c.div.withConfig({displayName:"style__StyledValueAlias",componentId:"eg9uyn-3"})(["position:relative;padding-left:20px;margin-top:10px;margin-bottom:10px;color:#393F44;font-size:16px;line-height:25px;"]),xe=J.c.div.withConfig({displayName:"style__IconBox",componentId:"eg9uyn-4"})(["color:#393F44;position:absolute;left:0;top:1px;"]),we=function(e){var t=e.category,n=e.value.alias,a=t.alias;return E.a.createElement(me,null,E.a.createElement(ve,null,E.a.createElement(xe,null,E.a.createElement(ge,null)),a),E.a.createElement(be,null,E.a.createElement(xe,null,"#"),a," Description"),E.a.createElement(ye,null,E.a.createElement(xe,null,"#"),n))},Ee=J.c.div.withConfig({displayName:"style__StyledSelectOptionTitle",componentId:"sc-42eb37-0"})(["font-size:14px;display:flex;align-items:center;font-weight:500;"]),Oe=J.c.div.withConfig({displayName:"style__StyledSelectOptionDescription",componentId:"sc-42eb37-1"})(["font-size:12px;padding-top:10px;"]),_e=J.c.div.withConfig({displayName:"style__StyledSelectOption",componentId:"sc-42eb37-2"})(["padding:10px 20px;border-bottom:1px solid #6f6f6f;color:",";&:hover{background-color:blue;cursor:pointer;color:white;}&:last-child{border-bottom:none;}"],(function(e){return e.isDisabled?"#eaeaea":"#6f6f6f"})),Ce=function(e){var t=e.data,n=e.isDisabled,a=e.innerProps,i=t.description,r=t.alias;return n?null:E.a.createElement(_e,a,E.a.createElement(Ee,null,r),i&&i.length>0&&E.a.createElement(Oe,null,i))},Ae=J.c.div.withConfig({displayName:"style__StyledSelectBox",componentId:"sc-1braopw-0"})(["position:relative;"]),ke={control:function(){return{display:"flex",border:"1px solid rgba(202,204,208,0.85)",borderRadius:"4px",padding:"3px 0"}}},Se={container:function(){return{position:"relative",boxSizing:"border-box",cursor:"pointer"}},indicatorSeparator:function(){return{display:"none"}},dropdownIndicator:function(e,t){return{color:"#c32d7b",transform:t.selectProps.menuIsOpen?"rotate(180deg)":"none",transition:"all 0.2s ease-out"}},indicatorsContainer:function(){return{color:"#c32d7b",display:"flex",padding:"8px",transition:"color 150ms",boxSizing:"border-box",position:"relative",top:"5px"}},control:function(){return{display:"flex",border:"none",borderRadius:"4px",padding:"3px 0"}}};function je(){return(je=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var Te=function(e){var t=e.isCustom,n=e.isPopup,a=e.configuration,i=Object(fe.a)(e,["isCustom","isPopup","configuration"]),r=a.value,o=a.category,c=Object(w.useState)(!1),s=Object(pe.a)(c,2),l=s[0],u=s[1],d=Object(w.useState)(!1),p=Object(pe.a)(d,2),f=p[0],h=p[1];return E.a.createElement(Ae,{onMouseEnter:function(){return u(!0)},onMouseLeave:function(){return u(!1)}},E.a.createElement(he.a,je({},i,{onMenuOpen:function(){return h(!0)},onMenuClose:function(){return h(!1)},styles:t?Se:ke,components:t?{Option:Ce}:null})),n&&l&&!f&&E.a.createElement(we,{category:o,value:r}))},De=J.c.div.withConfig({displayName:"component__StyledContainer",componentId:"sc-1bmwxtk-0"})(["margin:10px;flex-basis:100%;padding:10px;width:100%;max-width:300px;box-sizing:border-box;"]),Ie=function(e){e.theme;var t=e.value,n=e.columns,a=e.configuration,i=e.patchConfiguration;return E.a.createElement(de,null,E.a.createElement(De,null,E.a.createElement(Te,{menuPlacement:"top",defaultValue:t,onChange:function(e){i({value:Object(A.a)({},a.value,{name:e.identifier,alias:e.alias})})},getOptionLabel:function(e){return e.alias},getOptionValue:function(e){return e.identifier},options:n,configuration:a,isCustom:!0,isPopup:!0})))},Ne=M((function(e){return{theme:e.theme,value:le(e),configuration:e.configuration,widgetRelevantProps:e.editor.dataset.attributes.widgetRelevantProps,columns:ue(e)}}),{patchConfiguration:ie})(Ie),Fe=n(44),Pe=n.n(Fe);function Me(){return(Me=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var Re=J.c.button.withConfig({displayName:"component__StyledButton",componentId:"l5yyzu-0"})(["cursor:pointer;font-size:16px;color:#393f44;border:1px solid rgba(202,204,208,0.85);background:transparent;padding:10px 20px;border-radius:5px;outline:1;"," "," "," "," ",""],(function(e){return e.size&&"small"===e.size&&Object(J.b)(["padding:7px 15px;"])}),(function(e){return e.type&&"cta"===e.type&&Object(J.b)(["background:",";color:#fff;border:1px solid transparent;"],e.color)}),(function(e){return e.type&&"highlight"===e.type&&Object(J.b)(["color:",";border:1px solid ",";"],e.color,e.color)}),(function(e){return e.type&&"default"===e.type&&Object(J.b)(["&:hover,&.active{","}"],(function(e){return e.color&&Object(J.b)(["border:1px solid ",";color:",";"],e.color,e.color)}))}),(function(e){return e.active&&Object(J.b)(["border:1px solid ",";color:",";"],e.color,e.color)})),Le=function(e){var t=e.type,n=void 0===t?"default":t,a=e.theme,i=e.children,r=Object(fe.a)(e,["type","theme","children"]);return E.a.createElement(Re,Me({},r,{color:a.color,type:n}),i)},ze=M((function(e){return{theme:e.theme}}))(Le),We=J.c.div.withConfig({displayName:"style__StyledContainer",componentId:"opri8d-0"})(["margin:10px;",""],(function(e){return e.isCompact&&Object(J.b)(["display:flex;align-items:center;"])})),qe=J.c.div.withConfig({displayName:"style__StyledSelectBox",componentId:"opri8d-1"})(["",""],(function(e){return e.isCompact&&Object(J.b)(["width:100%;padding-right:15px;"])})),Be={control:function(){return{display:"flex",border:"1px solid rgba(202,204,208,0.85)",borderRadius:"4px",padding:"3px 0"}},option:function(e){return Object(A.a)({},e)}},Ue=function(e){var t=e.patchConfiguration,n=e.options,a=e.value,i=e.theme,r=e.setTheme,o=Object(w.useState)(Pe()(n,{value:a})),c=Object(pe.a)(o,2),s=c[0],l=c[1],u=i.compact,d=u.isCompact,p=u.isOpen;Object(w.useEffect)((function(){V()(Pe()(n,{value:a}),s)||l(Pe()(n,{value:a}))}),[s,a]);return E.a.createElement(We,{isCompact:d},E.a.createElement(qe,{isCompact:d},E.a.createElement(he.a,{onChange:function(e){t({chartType:e.value})},value:s,options:n,styles:Be})),d&&E.a.createElement(ze,{type:"highlight",onClick:function(){r(Object(A.a)({},i,{compact:{isCompact:d,isOpen:!p}}))}},"Settings"))},Ye=M((function(e){return{options:e.configuration.availableCharts,value:e.configuration.chartType,theme:e.theme}}),{patchConfiguration:ie,setTheme:q})(Ue),Ve=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return"\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.09);\n\n  border-color: rgba(26, 28, 34, 0.1);\n  border-style: solid;\n\n  border-width: ".concat(e,"px ").concat(t,"px ").concat(n,"px ").concat(a,"px;\n")},Ge=J.c.div.withConfig({displayName:"style__StyledContainer",componentId:"sc-1qafyg5-0"})(["display:flex;flex-flow:column;height:calc(100% - ",");background:#fff;flex:1;width:100%;",""],"100px",Ve()),He=J.c.div.withConfig({displayName:"style__RestoringWidget",componentId:"sc-1qafyg5-1"})(["height:300px;display:flex;align-items:center;justify-content:center;"]),Xe=J.c.h4.withConfig({displayName:"style__RestoringWidgetTitle",componentId:"sc-1qafyg5-2"})(["color:#a9a9a9;font-size:21px;"]),Ke=function(e){e.widget;var t=e.editor,n=t.restoring,a=t.initialized;return E.a.createElement(Ge,null,E.a.createElement(Ye,null),a&&!n&&E.a.createElement(ne,null),!a&&E.a.createElement(He,null,E.a.createElement(Xe,null,"Loading widget...")),n&&E.a.createElement(He,null,E.a.createElement(Xe,null,"Building widget...")),a&&!n&&E.a.createElement(Ne,null))},Je=M((function(e){return{editor:e.editor,widget:e.widget}}))(Ke),Qe=n(141),Ze=J.c.div.withConfig({displayName:"style__StyledAccordion",componentId:"mzy7xu-0"})(["width:100%;padding-top:24px;padding-bottom:24px;"]),$e=J.c.div.withConfig({displayName:"style__StyledAccordionContent",componentId:"mzy7xu-1"})(['display:"block";max-height:',";overflow-y:",";transition:all 0.2s ease-out;padding-left:24px;padding-top:",";padding-bottom:",";"],(function(e){return e.scrollHeight+"px"||!1}),(function(e){return e.scrollHeight?"visible":"hidden"}),(function(e){return e.scrollHeight?"18px":"0"}),(function(e){return e.scrollHeight?"18px":"0"})),et=J.c.a.withConfig({displayName:"style__StyledAccordionButton",componentId:"mzy7xu-2"})(['display:block;height:25px;color:#393f44;font-size:16px;font-weight:bold;line-height:25px;position:relative;padding-left:25px;cursor:pointer;&:before{content:" ";width:10px;height:10px;border-radius:50%;background:#c32d7b;position:absolute;left:0;top:8px;}']),tt=J.c.div.withConfig({displayName:"style__StyledAccordionSection",componentId:"mzy7xu-3"})(['padding-top:11px;padding-bottom:11px;position:relative;&:before{content:" ";height:1px;width:calc(100% - 24px);display:block;position:absolute;top:0;background-color:#d2d3d6;margin-left:24px;}&:first-child{&:before{display:none;}}']),nt=function(e){var t=e.title,n=e.openDefault,a=e.children,i=Object(w.useRef)({}),r=Object(w.useState)(0),o=Object(pe.a)(r,2),c=o[0],s=o[1],l=Object(w.useState)(!1),u=Object(pe.a)(l,2),d=u[0],p=u[1],f=function(){p(!d);var e=i.current,t=c?0:e.scrollHeight;s(t)};return Object(w.useEffect)((function(){setTimeout((function(){return n?f():null}),0)}),[]),E.a.createElement(tt,null,E.a.createElement(et,{onClick:function(){return f()}},t),E.a.createElement($e,{ref:i,scrollHeight:c},E.a.createElement(Qe.a,{handleHeight:!0,skipOnMount:!0,onResize:function(){var e=i.current;if(e.scrollHeight>0&&d){var t=e.scrollHeight;s(t)}}},a)))},at=function(e){var t=e.children;return E.a.createElement(Ze,null,t)},it=J.c.div.withConfig({displayName:"style__StyledTabsContainer",componentId:"qvkojo-0"})(["position:relative;"]),rt=J.c.div.withConfig({displayName:"style__StyledTabsContent",componentId:"qvkojo-1"})(["display:",";"],(function(e){return e.active?"block":"none"})),ot=J.c.ul.withConfig({displayName:"style__StyledList",componentId:"qvkojo-2"})(["display:flex;justify-content:space-between;padding:20px 0;list-style:none;"]),ct=J.c.li.withConfig({displayName:"style__StyledListLabel",componentId:"qvkojo-3"})(["color:red;padding-right:5px;padding-left:5px;&:first-child{padding-left:0;}&:last-child{padding-right:0;}"]);function st(){return(st=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var lt=function(e){return E.a.createElement(ze,st({style:{height:"100%"}},e))},ut=function(e){var t=e.children,n=Object(w.useState)(0),a=Object(pe.a)(n,2),i=a[0],r=a[1];return Object(w.useEffect)((function(){var e=t.findIndex((function(e){return e.props.default}));r(-1===e?0:e)}),[]),E.a.createElement(it,null,E.a.createElement(ot,null,t.map((function(e,t){var n=e.props.label;return n?E.a.createElement(ct,{key:t},E.a.createElement(lt,{onClick:function(){return r(t)},active:t===i},n)):null}))),t.map((function(e,t){var n=e.props.children;return E.a.createElement(rt,{key:t,active:t===i},n)})))},dt=function(e){var t=e.children;return e.label?t:null},pt=n(135);function ft(){return(ft=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var ht=Object(J.c)(pt.a).withConfig({displayName:"component__StyledSlider",componentId:"ps9f57-0"})(["height:4px;width:inherit;"]),gt=J.c.div.withConfig({displayName:"component__StyledThumb",componentId:"ps9f57-1"})(["height:18px;line-height:18px;width:18px;background-color:#fff;border:3px solid ",";border-radius:50%;transform:translateY(-50%);z-index:0 !important;top:50%;cursor:grab;"],(function(e){return e.theme.slider.track})),mt=J.c.div.withConfig({displayName:"component__StyledTrack",componentId:"ps9f57-2"})(["top:0;bottom:0;background:",";border-radius:999px;"],(function(e){return e.isArray?e.isArray&&1===e.index?e.theme.slider.track:e.theme.slider.trackBackground:2===e.index?e.theme.slider.track:1===e.index?e.theme.slider.trackBackground:e.theme.slider.track})),vt=function(e,t){return E.a.createElement(gt,e)},bt=function(e,t){return E.a.createElement(mt,ft({},e,{isArray:Array.isArray(t.value),index:t.index}))},yt=function(e){var t=e.min,n=void 0===t?1:t,a=e.max,i=void 0===a?500:a,r=e.step,o=void 0===r?1:r,c=e.value,s=e.defaultValue,l=e.theme,u=e.onChange,d=void 0===u?function(){}:u,p=e.onDone,f=void 0===p?function(){}:p;return E.a.createElement(J.a,{theme:l},E.a.createElement(ht,{onAfterChange:f,onChange:d,renderTrack:bt,renderThumb:vt,value:c,step:o,defaultValue:s,max:i,min:n}))},xt=M((function(e){return{theme:e.theme}}))(yt),wt=J.c.label.withConfig({displayName:"form-label__FormLabel",componentId:"dg5fl6-0"})(["display:block;padding:0 0 10px 0;color:#393f44;font-weight:700;font-size:13px;"]),Et=J.c.div.withConfig({displayName:"input-group__InputGroup",componentId:"sc-1dcephl-0"})(["position:relative;width:100%;",""],(function(e){return!e.noMargins&&"margin: 0 0 15px 0;"})),Ot=J.c.input.withConfig({displayName:"input__Input",componentId:"sc-1ao902g-0"})(['width:100%;box-sizing:border-box;padding:14px 10px;background:#ffffff;border:1px solid rgba(202,204,208,0.85);border-radius:4px;color:#393f44;font-size:14px;&[type="number"]{box-sizing:content-box;padding:8px 10px;}']);var _t=function(e){function t(e){var n,a,i,r;return Object(j.a)(this,t),n=Object(D.a)(this,Object(I.a)(t).call(this,e)),a=Object(U.a)(n),i="handleUpdate",r=H()((function(){var e=n.props,t=e.configuration,a=e.patchConfiguration,i=n.state,r=i.title,o=i.caption,c=i.yAxis,s=i.xAxis;a({title:r,caption:o,category:Object(A.a)({},t.category,{alias:c}),value:Object(A.a)({},t.value,{alias:s})})}),1e3),i in a?Object.defineProperty(a,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):a[i]=r,n.state=n.stateFromProps(e.configuration),n}return Object(N.a)(t,e),Object(T.a)(t,[{key:"componentDidUpdate",value:function(e){var t=e.configuration,n=this.props.configuration;V()(this.stateFromProps(t),this.stateFromProps(n))||this.setState(this.stateFromProps(n))}},{key:"stateFromProps",value:function(e){return{title:e?e.title:"",caption:e?e.caption:"",yAxis:e?e.category.alias:"",xAxis:e?e.value.alias:""}}},{key:"setTitle",value:function(e){this.setState({title:e}),this.handleUpdate()}},{key:"setCaption",value:function(e){this.setState({caption:e}),this.handleUpdate()}},{key:"setYAxis",value:function(e){this.setState({yAxis:e}),this.handleUpdate()}},{key:"setXAxis",value:function(e){this.setState({xAxis:e}),this.handleUpdate()}},{key:"render",value:function(){var e=this,t=this.state,n=t.title,a=t.caption,i=t.xAxis,r=t.yAxis;return E.a.createElement(de,null,E.a.createElement(Et,null,E.a.createElement(wt,{htmlFor:"options-title"},"Title"),E.a.createElement(Ot,{type:"text",placeholder:"Add title",name:"options-title",value:n,onChange:function(t){return e.setTitle(t.target.value)}})),E.a.createElement(Et,null,E.a.createElement(wt,{htmlFor:"options-title"},"Caption"),E.a.createElement(Ot,{type:"text",placeholder:"Add caption",name:"options-capton",value:a,onChange:function(t){return e.setCaption(t.target.value)}})),E.a.createElement(de,{row:!0},E.a.createElement(Et,null,E.a.createElement(wt,{htmlFor:"options-x-axis"},"X axis"),E.a.createElement(Ot,{type:"text",placeholder:"Overwrite axis name",name:"options-x-axis",value:i,onChange:function(t){return e.setXAxis(t.target.value)}})),E.a.createElement(Et,null,E.a.createElement(wt,{htmlFor:"options-y-axis"},"Y axis"),E.a.createElement(Ot,{type:"text",placeholder:"Overwrite axis name",name:"options-y-axis",value:r,onChange:function(t){return e.setYaxis(t.target.value)}}))))}}]),t}(E.a.Component),Ct=M((function(e){return{theme:e.theme,configuration:e.configuration}}),{patchConfiguration:ie})(_t),At={control:function(){return{display:"flex",border:"1px solid rgba(202,204,208,0.85)",borderRadius:"4px",padding:"3px 0"}},option:function(e){return Object(A.a)({},e)}},kt=[{label:"Ascending",value:"asc"},{label:"Descending",value:"desc"}],St=function(e){var t=e.orderBy,n=e.patchConfiguration,a=Object(w.useState)(Pe()(kt,{value:t.orderType})),i=Object(pe.a)(a,2),r=i[0],o=i[1];Object(w.useEffect)((function(){t.orderType!==r.value&&o(Pe()(kt,{value:t.orderType}))}),[t,r.value]);return E.a.createElement(de,null,E.a.createElement(Et,null,E.a.createElement(wt,{htmlFor:"options-title"},"Ascending or Descending"),E.a.createElement(he.a,{onChange:function(e){n({orderBy:Object(A.a)({},t,{orderType:e.value})})},value:r,options:kt,styles:At})))},jt=M((function(e){return{orderBy:e.configuration.orderBy}}),{patchConfiguration:ie})(St),Tt=J.c.div.withConfig({displayName:"style__StyledTableBox",componentId:"sc-1dqyv6r-0"})(["width:100%;height:100%;overflow:auto;"]),Dt=J.c.table.withConfig({displayName:"style__StyledTable",componentId:"sc-1dqyv6r-1"})(["border-collapse:separate;border-spacing:0;width:100%;padding:0;border-radius:4px;overflow:hidden;border:1px solid rgba(26,28,34,.1);font-size:14px;margin-bottom:20px;"]),It=J.c.tr.withConfig({displayName:"style__StyledTr",componentId:"sc-1dqyv6r-2"})(["background-color:#fff;box-sizing:border-box;"]),Nt=J.c.td.withConfig({displayName:"style__StyledTd",componentId:"sc-1dqyv6r-3"})(["width:100%;padding:20px;text-align:",";"],(function(e){return e.center?"center":"left"})),Ft=J.c.td.withConfig({displayName:"style__StyledTh",componentId:"sc-1dqyv6r-4"})(["position:relative;font-size:14px;color:#393f44;font-weight:700;white-space:nowrap;padding:20px;"]),Pt=function(e){var t=e.widgetData,n=e.configuration,a=n.value.alias,i=n.category.alias;return E.a.createElement(Tt,null,E.a.createElement(Dt,null,E.a.createElement("thead",null,E.a.createElement(It,null,E.a.createElement(Ft,null,i),E.a.createElement(Ft,null,a))),E.a.createElement("tbody",null,t&&t.map((function(e,t){return E.a.createElement(It,{key:t},E.a.createElement(Nt,null,e.x),E.a.createElement(Nt,{center:!0},e.y))})))))},Mt=M((function(e){return{widgetData:e.editor.widgetData,configuration:e.configuration}}))(Pt),Rt=n(142),Lt=n(136),zt=n.n(Lt),Wt=J.c.div.withConfig({displayName:"style__StyledField",componentId:"sc-1o5rag-0"})(["box-sizing:border-box;height:221px;width:100%;border:1px solid rgba(202,204,208,0.85);border-radius:4px;background-color:#FFFFFF;padding:0;font-size:14px;"]),qt={keys:"#C32D7B",number:"#2C75B0",string:"#C32D7B",background:"white",background_warning:"#ffebeb"},Bt={labelColumn:{display:"none",boxSizing:"border-box"},body:{fontSize:"14px",height:"100%",width:"100%"},outerBox:{width:"100%",height:"100%",boxSizing:"border-box"},container:{height:"100%",width:"100%",boxSizing:"border-box"},warningBox:{width:"100%",position:"absolute",left:"0",bottom:"-62px"},contentBox:{padding:"20px 0 20px 20px",height:"100%",width:"100%",boxSizing:"border-box"}},Ut=function(e){var t=e.json,n=e.onChange,a=void 0===n?function(){}:n;return E.a.createElement(Wt,null,E.a.createElement(Rt.a,{placeholder:t,colors:qt,locale:zt.a,style:Bt,onChange:a}))},Yt=R("EDITOR/setFilters"),Vt={setFilters:Yt},Gt=n(33),Ht=n(6),Xt=n.n(Ht),Kt=n(19),Jt=n(137),Qt=n.n(Jt),Zt=["range","value"],$t=["FILTER_ON_VALUES","TEXT_CONTAINS","TEXT_NOT_CONTAINS","TEXT_STARTS_WITH","TEXT_ENDS_WITH"],en={values:[0,100],type:"range",notNull:!0,max:500,min:0},tn={column:null,label:null,dataType:null,indicator:"range",filter:en},nn=[{label:"Between",value:"range"},{label:"Equals",value:"value"}],an=[{label:"Filter by values",value:"FILTER_ON_VALUES"},{label:"Text Contains",value:"TEXT_CONTAINS"},{label:"Text does not contain",value:"TEXT_NOT_CONTAINS"},{label:"Text starts with",value:"TEXT_STARTS_WITH"},{label:"Text ends with",value:"TEXT_ENDS_WITH"}],rn=J.c.div.withConfig({displayName:"style__StyledCheckbox",componentId:"sc-166tcgo-0"})(['color:#393f44;input[type="checkbox"]{opacity:0;position:absolute;}label{cursor:pointer;position:relative;display:inline-block;padding-left:22px;font-size:14px;}label::before,label::after{position:absolute;content:"";display:inline-block;}label::before{height:16px;width:16px;border:1px solid #3bb2d0;border-radius:5px;left:0px;top:0;}label::after{height:3px;width:6px;border-left:2px solid #3bb2d0;border-bottom:2px solid #3bb2d0;-webkit-transform:rotate(-45deg);-ms-transform:rotate(-45deg);transform:rotate(-45deg);left:5px;top:6px;}input[type="checkbox"] + label::after{content:none;}input[type="checkbox"]:checked + label::after{content:"";}input[type="checkbox"]:focus + label::before{box-shadow:0 0 3px #3bb2d0;}']),on=function(e){var t=e.filter,n=e.name,a=void 0===n?"untitled_checkbox":n,i=e.label,r=void 0===i?"":i,o=e.setData;return t?E.a.createElement(rn,null,E.a.createElement("input",{type:"checkbox",id:a,checked:t.filter.notNull,onChange:function(e){return o(e.target.value,t.id,"NOT_NULL_CHECK")}}),E.a.createElement("label",{for:a},r)):null};function cn(e){return Number(e)===e&&e%1!==0}function sn(){return(sn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var ln=J.c.div.withConfig({displayName:"component__StyledSliderBox",componentId:"sc-13c1gwt-0"})(["width:100%;display:flex;padding:20px 0;"]),un=J.c.div.withConfig({displayName:"component__StyledInputBox",componentId:"sc-13c1gwt-1"})(["width:100%;display:flex;align-items:center;justify-content:",";input{max-width:100px;}"],(function(e){return e.isDouble?"space-between":"flex-end"})),dn=function(e){var t=e.label,n=e.min,a=void 0===n?null:n,i=e.max,r=void 0===i?null:i,o=e.value,c=e.minDistance,s=void 0===c?1:c,l=e.onChange,u=void 0===l?function(e){}:l,d=e.handleOnChangeValue,p=void 0===d?function(e,t){}:d,f=Array.isArray(o),h=cn(a)||cn(r),g=a,m=r;f?(g=o[0],m=o[1]):m=o||r,m-g<=s&&(g=m-s);var v=Object(A.a)({},null!==a&&{min:a},{},null!==r&&{max:r});return E.a.createElement(de,null,t&&E.a.createElement(wt,{htmlFor:"options-limit"},t),E.a.createElement(ln,null,E.a.createElement(xt,sn({},v,{step:h?.1:1,value:f?[g,m]:m,defaultValue:f?a:[a,r],onChange:function(e){return u(e)}}))),E.a.createElement(un,{isDouble:f},f&&E.a.createElement(Ot,sn({},v,{value:g,type:"number",name:"options-limit",onChange:function(e){return p(e.target.value,"minValue")}})),E.a.createElement(Ot,sn({},v,{value:m,type:"number",name:"options-limit",onChange:function(e){return p(e.target.value,"maxValue")}}))))},pn=M((function(e){return{theme:e.theme}}))(dn);function fn(){return(fn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var hn=function(e){var t=e.filter,n=e.disabled,a=void 0!==n&&n,i=e.setData,r=t.filter.values,o=t.fieldInfo?t.fieldInfo:{min:0,max:100},c=o.min,s=o.max,l=Object(pe.a)(r,2),u=l[0],d=l[1],p=Object(A.a)({},"date"!==t.dataType&&{min:c,max:s});return E.a.createElement(pn,fn({},p,{disabled:a,value:[u,d],onChange:function(e){return function(e){i(e,t.id,"range")}(e)},handleOnChangeValue:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"maxValue",a="maxValue"===n?[u,Number(e)]:[Number(e),d];i(a,t.id,"range")}}))},gn=Object(J.c)(Ot).withConfig({displayName:"component__StyledInput",componentId:"sc-8rrlsf-0"})(["text-align:left !important;"]),mn=function(e){var t=e.filter,n=e.disabled,a=void 0!==n&&n,i=e.setData,r=e.isNumeric,o=void 0===r||r,c=t.filter.values,s=t.fieldInfo?t.fieldInfo:{min:0,max:100},l=s.min,u=s.max,d=cn(l)||cn(u);return E.a.createElement(gn,{min:l,max:u,step:d?.1:1,disabled:a,value:c,type:o?"number":"text",name:"filter-value-".concat(t.id),onChange:function(e){return i(e.target.value,t.id,"value")}})},vn=function(e){var t=e.filter,n=e.setData,a=void 0===n?function(){}:n,i=e.optionData,r=void 0===i?[]:i,o=r.find((function(e){return e.value===t.column}));return E.a.createElement(he.a,{value:o,placeholder:"Select Column",name:"filter-column-".concat(t.id),options:r,onChange:function(e){a(e,t.id,"columns")}})},bn=function(e){var t=e.filter,n=e.disabled,a=void 0!==n&&n,i=e.setData,r=void 0===i?function(){}:i,o=e.optionData,c=void 0===o?[]:o,s=t.filter.values;return E.a.createElement(he.a,{isDisabled:a,value:s||null,isMulti:!0,placeholder:"Select ".concat(t.column),name:"filter-string-values-".concat(t.id),options:c,onChange:function(e){r(e,t.id,"FILTER_ON_VALUES")}})},yn=function(e){var t=e.filter,n=e.disabled,a=void 0!==n&&n,i=e.setData,r=void 0===i?function(){}:i,o=e.optionData,c=void 0===o?[]:o,s="string"===t.indicator?t.filter.values:c.find((function(e){return e.value===t.indicator}));return E.a.createElement(he.a,{isDisabled:a,value:s||null,isMulti:"string"===t.indicator,placeholder:"string"===t.indicator?"Select ".concat(t.column):"Select Indicator",name:"filter-indicator-".concat(t.id),options:c,onChange:function(e){r(e,t.id,"indicator")}})},xn=J.c.div.withConfig({displayName:"style__StyledAddSection",componentId:"e43ipm-0"})(["position:absolute;top:-40px;right:0;"]),wn=function(e){var t=e.addFilter;return E.a.createElement(xn,null,E.a.createElement(ze,{size:"small",onClick:function(){return t()}},"Add Filter"))},En=J.c.div.withConfig({displayName:"style__StyledFilterBox",componentId:"wriuir-0"})(["position:relative;"]),On=J.c.div.withConfig({displayName:"style__StyledEmpty",componentId:"wriuir-1"})(["max-width:300px;margin:0 auto;display:flex;align-items:center;justify-content:center;text-align:center;"]),_n=J.c.div.withConfig({displayName:"style__StyledFilterSection",componentId:"wriuir-2"})(["padding:10px 0;position:relative;label{text-transform:capitalize;}"]),Cn=J.c.div.withConfig({displayName:"style__StyledFilter",componentId:"wriuir-3"})(["padding:15px 0 0 20px;margin:0 0 0 10px;border-left:1px solid #d2d3d6;"]),An=J.c.div.withConfig({displayName:"style__StyledDeleteBox",componentId:"wriuir-4"})(["position:absolute;right:0;top:50%;transform:translate(-50px,-50%);button{font-size:12px;padding:7px 10px;border:none;font-weight:500;}"]),kn=function(e){var t=e.setFilters,n=e.filters,a=void 0===n?[]:n,i=e.fields,r=void 0===i?[]:i,o=e.configuration,c=e.datasetId,s=r.map((function(e){return{label:e.metadata&&e.metadata.alias?e.metadata.alias:e.columnName.replace(/_/gi," "),value:e.columnName,dataType:e.type}})),l=function(){var e=Object(Kt.a)(Xt.a.mark((function e(n,i,s){var l;return Xt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.FiltersService.patchFilters(a,{values:n,id:i,type:s},o,c,r);case 2:l=e.sent,t({list:l});case 4:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}();return E.a.createElement(En,null,E.a.createElement(wn,{addFilter:function(){t({list:[].concat(Object(Gt.a)(a),[Object(A.a)({},tn,{id:Qt()("we-filter-")})])})}}),!a.length&&E.a.createElement(On,null,"No filters found. Please, add them."),a.map((function(e){return E.a.createElement(_n,{key:e.id},E.a.createElement(Et,{noMargins:!0},E.a.createElement(vn,{filter:e,setData:l,optionData:s}),E.a.createElement(An,null,E.a.createElement(ze,{type:"highlight",onClick:function(){return function(e){var n=a.filter((function(t){return t.id!==e}))||[];t({list:n})}(e.id)}},"Delete"))),null!==e.column&&E.a.createElement(Cn,null,Zt.indexOf(e.indicator)>-1&&E.a.createElement(Et,{noMargins:"range"===e.indicator},E.a.createElement(yn,{filter:e,disabled:null===e.column,setData:l,optionData:nn})),$t.indexOf(e.indicator)>-1&&E.a.createElement(Et,null,E.a.createElement(yn,{filter:e,disabled:null===e.column,setData:l,optionData:an})),$t.indexOf(e.indicator)>-1&&E.a.createElement(Et,null,"FILTER_ON_VALUES"===e.indicator&&E.a.createElement(bn,{filter:e,setData:l,optionData:e.fieldInfo}),"FILTER_ON_VALUES"!==e.indicator&&E.a.createElement(mn,{isNumeric:!1,filter:e,setData:l})),Zt.indexOf(e.indicator)>-1&&E.a.createElement(Et,null,"range"===e.indicator&&E.a.createElement(hn,{disabled:null===e.column,filter:e,setData:l}),"value"===e.indicator&&E.a.createElement(mn,{disabled:null===e.column,filter:e,setData:l})),E.a.createElement(on,{filter:e,name:"filter-not-null-".concat(e.id),label:"Not null values",setData:l})))})))},Sn=M((function(e){return{configuration:e.configuration,datasetId:e.editor.dataset.id,filters:e.filters.list,fields:e.editor.fields}}),{setFilters:Yt})(kn),jn=J.c.div.withConfig({displayName:"component__StyledContainer",componentId:"sc-1tx06u6-0"})(["flex:1;background:#fff;height:calc(100% - "," - 20px);padding:0 30px;margin:10px 0;overflow-y:scroll;"," "," ",""],"100px",Ve(1,1,1,0),(function(e){return e.compact.isCompact&&Object(J.b)(["visibility:hidden;max-height:0;position:absolute;top:65px;left:0;margin:0;width:100%;transition:all 0.3s ease-in-out;"])}),(function(e){return e.compact.isCompact&&e.compact.isOpen&&Object(J.b)(["box-sizing:border-box;display:block;z-index:auto;visibility:visible;max-height:calc(100% - "," - 65px);"],"100px")})),Tn=function(e){var t=e.orderBy,n=e.compact;return E.a.createElement(jn,{compact:n},E.a.createElement(ut,null,E.a.createElement(dt,{label:"General"},E.a.createElement(at,null,E.a.createElement(nt,{title:"Description and labels",openDefault:!0},E.a.createElement(Ct,null)),E.a.createElement(nt,{title:"Filters"},E.a.createElement(Sn,null)),E.a.createElement(nt,{title:"Order"},t&&E.a.createElement(jt,null)))),E.a.createElement(dt,{label:"Visual style"},"Visual style"),E.a.createElement(dt,{label:"Advanced"},E.a.createElement(Ut,null)),E.a.createElement(dt,{label:"Table view"},E.a.createElement(Mt,null))))},Dn=M((function(e){return{limit:e.configuration.limit,orderBy:e.configuration.orderBy,compact:e.theme.compact}}),{patchConfiguration:ie})(Tn);function In(){return(In=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var Nn=J.c.svg.withConfig({displayName:"CloseIcon__Icon",componentId:"xts4iy-0"})(["&:hover{path{fill:",";}}"],(function(e){return(e.hoverColor?e.hoverColor:"#C32D7B")||"auto"})),Fn=function(e){return E.a.createElement(Nn,In({},e,{viewBox:"0 0 32 32"}),E.a.createElement("path",{d:"M16 11.636l-11.636-11.636-4.364 4.364 11.636 11.636-11.636 11.636 4.364 4.364 11.636-11.636 11.636 11.636 4.364-4.364-11.636-11.636 11.636-11.636-4.364-4.364z"}))},Pn=J.c.div.withConfig({displayName:"style__StyledModalBox",componentId:"sc-1ia4c7k-0"})(["position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.3);transition:all .16s cubic-bezier(.47,0,.745,.715);z-index:",";visibility:",";opacity:",";display:flex;justify-content:center;align-items:center;"],(function(e){return e.isOpen?1100:-1}),(function(e){return e.isOpen?"visible":"hidden"}),(function(e){return e.isOpen?1:0})),Mn=J.c.div.withConfig({displayName:"style__StyledModalContainer",componentId:"sc-1ia4c7k-1"})(["-webkit-transition:-webkit-transform .24s cubic-bezier(.215,.61,.355,1);transition:-webkit-transform .24s cubic-bezier(.215,.61,.355,1);transition:transform .24s cubic-bezier(.215,.61,.355,1);transition:transform .24s cubic-bezier(.215,.61,.355,1),-webkit-transform .24s cubic-bezier(.215,.61,.355,1);-webkit-transform:translateY(0);transform:",";display:-webkit-box;display:flex;position:relative;width:calc(100% - 50px);max-width:880px;background:#fff;box-shadow:0 1px 1px rgba(0,0,0,.15);z-index:1;"],(function(e){return e.isOpen?"translateY(0)":"translateY(-35px)"})),Rn=J.c.div.withConfig({displayName:"style__StyledModalContent",componentId:"sc-1ia4c7k-2"})(["position:relative;width:100%;max-height:85vh;min-height:150px;overflow:auto;padding:72px;-webkit-overflow-scrolling:touch;box-shadow:0 7px 15px 0 rgba(0,0,0,.15);"]),Ln=J.c.button.withConfig({displayName:"style__StyledModalCloseBtn",componentId:"sc-1ia4c7k-3"})(["fill:#000;display:block;position:absolute;top:15px;right:15px;width:30px;height:30px;padding:0;border:0;background-color:transparent;cursor:pointer;z-index:2;outline:none;"]),zn=J.c.div.withConfig({displayName:"style__StyledActions",componentId:"sc-1ia4c7k-4"})(["padding-top:60px;"]),Wn=function(e){var t=e.isOpen,n=e.closeModal,a=e.children;return E.a.createElement(Pn,{isOpen:t},E.a.createElement(Mn,{isOpen:t},E.a.createElement(Rn,null,E.a.createElement(Ln,{onClick:function(){return n()}},E.a.createElement(Fn,{width:"20px",height:"20px",hoverColor:"#C32D7B"})),a,E.a.createElement(zn,null,E.a.createElement(ze,{onClick:function(){return n()},type:"cta"},"Ok, got it!")))))},qn=J.c.footer.withConfig({displayName:"component__StyledFooter",componentId:"t079zl-0"})(["width:100%;height:",";align-self:flex-end;display:flex;align-items:center;justify-content:space-between;padding:0 30px;"],"100px"),Bn=function(e){var t=e.authenticated,n=e.onSave,a=Object(w.useState)(!1),i=Object(pe.a)(a,2),r=i[0],o=i[1];return E.a.createElement(qn,null,E.a.createElement(Wn,{isOpen:r,closeModal:function(){return o(!1)}},E.a.createElement("h2",null,"How to customize the visualization")),E.a.createElement(ze,{onClick:function(){return o(!0)},type:"highlight"},"Need help?"),t&&E.a.createElement(ze,{type:"cta",onClick:n},"Save widget"))},Un=M((function(e){return{authenticated:e.editor.authenticated}}))(Bn),Yn=J.c.div.withConfig({displayName:"style__StyledContainer",componentId:"sc-1testk7-0"})(["width:100%;",""],(function(e){return e.isCompact?Object(J.b)(["box-sizing:border-box;position:relative;max-width:600px;margin:0 auto;height:calc(100% - ",");"],"100px"):Object(J.b)(["height:100%;display:flex;flex-flow:wrap;justify-content:space-between;flex-flow:column;@media only screen and (min-width:768px){flex-flow:wrap;}"])}));function Vn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Gn,Hn=function(e){function t(e){var n;Object(j.a)(this,t),n=Object(D.a)(this,Object(I.a)(t).call(this,e)),Vn(Object(U.a)(n),"resolveAuthentication",H()((function(e){(0,n.props.setEditor)({authenticated:e})}),1e3)),Vn(Object(U.a)(n),"initializeRestoration",H()((function(e){n.dataService.restoreEditor(e)}),1e3)),Vn(Object(U.a)(n),"resolveTheme",H()((function(e){(0,n.props.setTheme)(e)}),1e3));var a=n.props,i=a.datasetId,r=a.adapter,o=a.setEditor,c=a.dispatch,s=a.theme;return n.onSave=n.onSave.bind(Object(U.a)(n)),n.dataService=new P.DataService(i,r,o,c),n.dataService.resolveInitialState(),n.resolveTheme(s),n}return Object(N.a)(t,e),Object(T.a)(t,[{key:"componentWillMount",value:function(){this.props.authenticated&&this.resolveAuthentication()}},{key:"componentDidUpdate",value:function(e){var t=e.datasetId,n=e.theme,a=e.authenticated,i=this.props,r=i.datasetId,o=i.theme,c=i.authenticated;V()(r,t)||this.initializeRestoration(r),V()(o,n)||this.resolveTheme(o),V()(c,a)||this.resolveAuthentication(c)}},{key:"onSave",value:function(){var e=this.props,t=e.onSave,n=e.dispatch,a=e.configuration,i=e.widget;"function"===typeof t&&t(this.dataService.resolveUpdates(a,i)),n({type:P.constants.sagaEvents.EDITOR_SAVE})}},{key:"render",value:function(){var e=this.props,t=e.configuration,n=e.theme.compact;return E.a.createElement(Yn,n,E.a.createElement(Je,null),t.limit&&E.a.createElement(Dn,null),E.a.createElement(Un,{onSave:this.onSave}))}}]),t}(E.a.Component),Xn=M((function(e){return{editor:e.editor,configuration:e.configuration,widget:e.widget}}),(function(e){return{dispatch:e,setEditor:function(t){return e(z(t))},setTheme:function(t){return e(q(t))}}}))(Hn),Kn=function(e){function t(){return Object(j.a)(this,t),Object(D.a)(this,Object(I.a)(t).apply(this,arguments))}return Object(N.a)(t,e),Object(T.a)(t,[{key:"render",value:function(){var e=this.props,t=e.authenticated,n=e.onSave,a=e.datasetId,i=e.adapter,r=e.theme,o=e.compact,c=void 0===o||o;if("function"!==typeof i)throw new Error("Widget editor: Missing prop adapter and adapter needs to be of type Adapter");return E.a.createElement(Xn,{authenticated:t,onSave:n,datasetId:a,adapter:new i,theme:Object(A.a)({},r,{compact:{isCompact:c,isOpen:!1}})})}}]),t}(E.a.Component),Jn=n(2),Qn=Object(Jn.a)({},z,(function(e,t){var n=t.payload;return Object(A.a)({},e,{},n)})),Zn={authenticated:!1,restoring:!1,initialized:!1,dataset:null,widget:null,widgetData:null,errors:null},$n=Object(Jn.a)({},q,(function(e,t){var n=t.payload;return Object(A.a)({},e,{},n)})),ea={compact:{isCompact:!1,isOpen:!1},color:"#C32D7B",slider:{track:"#a3daf3",trackBackground:"#f5f5f5"}},ta=R("WIDGET/setWidget"),na={setWidget:ta},aa=Object(Jn.a)({},ta,(function(e,t){var n=t.payload;return Object(A.a)({},e,{},n)})),ia={},ra=(Gn={},Object(Jn.a)(Gn,ae,(function(e,t){var n=t.payload;return Object(A.a)({},e,{},n)})),Object(Jn.a)(Gn,ie,(function(e,t){var n=t.payload;return Object(A.a)({},e,{},n)})),Gn),oa={title:"",caption:"",visualizationType:"chart",chartType:"pie",availableCharts:[{value:"pie",label:"pie"},{value:"bar",label:"Bars"},{value:"line",label:"Line"},{value:"scatter",label:"Scatter"}]},ca=Object(Jn.a)({},Yt,(function(e,t){var n=t.payload;return Object(A.a)({},e,{},n)})),sa={list:[]},la={configuration:Object(F.handleModule)(g),editor:Object(F.handleModule)(s),theme:Object(F.handleModule)(u),filters:Object(F.handleModule)(v),widget:Object(F.handleModule)(f)},ua=Object(Jn.a)({},P.constants.APP_NAMESPACE,Object(k.combineReducers)(la)),da=n(143),pa=Object(da.a)(),fa=n(22),ha=Xt.a.mark(ma),ga=Xt.a.mark(va);function ma(){var e,t,n,a,i,r;return Xt.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,Object(fa.e)();case 2:return e=o.sent,t=e.widgetEditor.editor.widget.attributes,n=t.name,a=t.description,i=t.widgetConfig,r=Object(A.a)({},i.paramsConfig,{title:n,caption:a}),o.next=10,Object(fa.d)(ae(r));case 10:case"end":return o.stop()}}),ha)}function va(){return Xt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(fa.f)(P.constants.sagaEvents.DATA_FLOW_DATASET_WIDGET_READY,ma);case 2:case"end":return e.stop()}}),ga)}var ba=Xt.a.mark(Oa),ya=Xt.a.mark(_a),xa=Xt.a.mark(Ca),wa=Xt.a.mark(Aa),Ea=new P.StateProxy;function Oa(){var e,t,n,a,i,r,o;return Xt.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(fa.e)();case 2:return e=c.sent,t=e.widgetEditor,n=t.editor,a=t.configuration,i=n.widgetData,r=n.widget.attributes.widgetConfig,o=new P.VegaService(r,i,a),c.next=11,Object(fa.d)(ta(o.getChart()));case 11:Ea.cacheCurrent(a);case 12:case"end":return c.stop()}}),ba)}function _a(){var e,t,n,a,i;return Xt.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(fa.e)();case 2:return e=r.sent,t=e.widgetEditor,n=t.configuration,a=t.editor,r.next=8,Object(fa.b)([Ea,"sync"],n,a.dataset.id);case 8:if(!(i=r.sent).hasUpdates){r.next=17;break}if(!i.widgetData){r.next=15;break}return r.next=13,Object(fa.d)(z({widgetData:i.widgetData}));case 13:return r.next=15,Object(fa.b)(Ca);case 15:return r.next=17,Object(fa.f)(P.constants.sagaEvents.DATA_FLOW_PROXY_UPDATE,Ca);case 17:case"end":return r.stop()}}),ya)}function Ca(){var e,t,n,a,i,r,o;return Xt.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(fa.e)();case 2:return e=c.sent,t=e.widgetEditor,n=t.editor,a=t.configuration,i=n.widgetData,r=n.widget.attributes.widgetConfig,o=new P.VegaService(r,i,a),c.next=11,Object(fa.d)(ta(o.getChart()));case 11:case"end":return c.stop()}}),xa)}function Aa(){return Xt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(fa.f)(P.constants.sagaEvents.DATA_FLOW_VISUALISATION_READY,Oa);case 2:return e.next=4,Object(fa.f)(L("CONFIGURATION/patchConfiguration"),_a);case 4:case"end":return e.stop()}}),wa)}var ka=Xt.a.mark(Sa);function Sa(){return Xt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(fa.a)([Object(fa.c)(va),Object(fa.c)(Aa)]);case 2:case"end":return e.stop()}}),ka)}var ja=Kn,Ta=n(138),Da=Object(F.createAction)("PLAYGROUND/modifyOptions"),Ia={modifyOptions:Da},Na=Object(Jn.a)({},Da,(function(e,t){var n=t.payload;return Object(A.a)({},e,{},n)})),Fa={authToken:"",optionsOpen:!1,compactMode:!1,theme:{color:"#C32D7B"},dataset:"03bfb30e-829f-4299-bab9-b2be1b66b5d4"},Pa=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(k.combineReducers)(Object(A.a)({editorOptions:Object(F.handleModule)(x)},ua)),n=Object(k.applyMiddleware)(Ta.a,pa),a=Object(S.composeWithDevTools)(n),i=Object(k.createStore)(t,e,a);return pa.run(Sa),{store:i}},Ma=n(139),Ra=n.n(Ma),La=function(e){function t(e){return Object(j.a)(this,t),Object(D.a)(this,Object(I.a)(t).call(this,e))}return Object(N.a)(t,e),Object(T.a)(t,[{key:"handleOnSave",value:function(e){console.log("on save called from consumer with:"),console.log(e)}},{key:"render",value:function(){var e=this.props.editorOptions,t=e.compactMode,n=e.authToken,a=e.dataset,i=e.theme,r=!!n&&n.length>0;return E.a.createElement("div",{className:"widget-editor-wrapper"},E.a.createElement(ja,{compact:t,datasetId:a,onSave:this.handleOnSave,authenticated:r,adapter:Ra.a,theme:i}))}}]),t}(E.a.Component),za=Object(C.b)((function(e){return{editorOptions:e.editorOptions}}),{})(La),Wa=(n(274),function(e){function t(){return Object(j.a)(this,t),Object(D.a)(this,Object(I.a)(t).apply(this,arguments))}return Object(N.a)(t,e),Object(T.a)(t,[{key:"render",value:function(){var e=this.props,t=e.editorOptions,n=t.compactMode,a=t.authToken,i=t.dataset,r=t.optionsOpen,o=t.theme,c=e.modifyOptions,s="c-playground-options ".concat(r?"-open":"");return E.a.createElement("div",{className:s},E.a.createElement("h4",null,"Widget editor options"),E.a.createElement("label",{htmlFor:"token"},"Auth token"),E.a.createElement("input",{id:"token",type:"text",placeholder:"Bearer token",value:a,onChange:function(e){return c({authToken:e.target.value})}}),E.a.createElement("label",{htmlFor:"dataset"},"Active Dataset"),E.a.createElement("select",{id:"dataset",value:i,onChange:function(e){return c({dataset:e.target.value})}},E.a.createElement("option",{value:"03bfb30e-829f-4299-bab9-b2be1b66b5d4"},"Forest Sector Economic Contribution"),E.a.createElement("option",{value:"d446a52e-c4c1-4e74-ae30-3204620a0365"},"Access to Electricity"),E.a.createElement("option",{value:"20cc5eca-8c63-4c41-8e8e-134dcf1e6d76"},"Fires"),E.a.createElement("option",{value:"a86d906d-9862-4783-9e30-cdb68cd808b8"},"Global Power Plant Database"),E.a.createElement("option",{value:"1bc94710-d7ec-46f9-aa27-edddd87b1625"},"Cold Water Corals")),E.a.createElement("label",{htmlFor:"editor-compact-mode"},"Toggle Compact mode"),E.a.createElement("button",{onClick:function(){return c({compactMode:!n})}},n?"Set Default mode":"Set Compact mode"),E.a.createElement("label",{htmlFor:"theme-color"},E.a.createElement("span",{className:"color-presentation",style:{background:o.color}})," ","THEME - Color"),E.a.createElement("input",{id:"theme-color",type:"text",placeholder:"#00000",value:o.color,onChange:function(e){return c({theme:Object(A.a)({},o,{color:e.target.value})})}}))}}]),t}(E.a.Component)),qa=Object(C.b)((function(e){return{editorOptions:e.editorOptions}}),{modifyOptions:Da})(Wa),Ba=function(e){var t=e.optionsActive,n=e.modifyOptions;return E.a.createElement("button",{onClick:function(){return n({optionsOpen:!t})}},t?"Close options":"View options")},Ua=Object(C.b)((function(e){return{optionsActive:e.editorOptions.optionsOpen}}),{modifyOptions:Da})(Ba);n(275);var Ya=function(){var e=Pa().store;return E.a.createElement(C.a,{store:e},E.a.createElement("div",{className:"App"},E.a.createElement("header",{className:"App-header"},"Widget editor playground",E.a.createElement(Ua,null)),E.a.createElement(za,null),E.a.createElement(qa,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));_.a.render(E.a.createElement(Ya,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},46:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultVegaSchema=function(){return{$schema:"https://vega.github.io/schema/vega/v5.json",width:100,height:100,data:[],legend:[],config:[],signals:[],scales:[],axes:[],marks:[],range:{dotSize:[20,250],category20:["#3BB2D0","#2C75B0","#FAB72E","#EF4848","#65B60D","#C32D7B","#F577B9","#5FD2B8","#F1800F","#9F1C00","#A5E9E3","#B9D765","#393F44","#CACCD0","#717171"],ordinal:{scheme:"greens"},ramp:{scheme:"purples"}},axis:{labelFontSize:13,labelFont:"Lato",labelColor:"#717171",labelPadding:10,ticks:!0,tickSize:8,tickColor:"#A9ABAD",tickOpacity:.5,tickExtra:!1},axisX:{bandPosition:.5,domainWidth:1.2,domainColor:"#A9ABAD",labelAlign:"center",labelBaseline:"top"},axisY:{domain:!1,labelAlign:"left",labelBaseline:"bottom",tickOpacity:.5,grid:!0,ticks:!1,gridColor:"#A9ABAD",gridOpacity:.5},line:{interpolate:"linear",stroke:"#3BB2D0",fillOpacity:0}}},t.sqlFields={value:"x",category:"y"},t.default={defaultVegaSchema:t.defaultVegaSchema,sqlFields:t.sqlFields}},75:function(e,t,n){"use strict";var a=n(6),i=n(24),r=n(25),o=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function o(e){try{s(a.next(e))}catch(t){r(t)}}function c(e){try{s(a.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}s((a=a.apply(e,t||[])).next())}))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=c(n(97)),l=n(46),u=c(n(163)),d=function(){function e(t,n){i(this,e),this.configuration=t,this.sql="",this.datasetId=n,this.prepareSelectStatement(),this.prepareAggregate(),this.prepareFilters(),this.prepareGroupBy(),this.prepareOrderBy(),this.prepareOrder(),this.prepareLimit()}return r(e,[{key:"prepareSelectStatement",value:function(){var e=this.configuration.category;this.sql="SELECT ".concat(e.name," as ").concat(l.sqlFields.value)}},{key:"resolveTableName",value:function(){var e=this.configuration,t=e.value,n=e.category,a=t.tableName,i=n.tableName;if(!a&&!i)throw new Error("Filters service: canot parse table name from value nor category.");return a||i}},{key:"prepareAggregate",value:function(){var e=this.configuration,t=e.aggregateFunction,n=e.value.name;if(t){var a=t.toUpperCase();if("SUM"!==a&&"COUNT"!==a)throw new Error("Aggragate function (".concat(t,") not implemented in filter service."));this.sql="".concat(this.sql,", ").concat(a,"(").concat(n,") as ").concat(l.sqlFields.category," FROM ").concat(this.resolveTableName())}else this.sql="".concat(this.sql,", ").concat(n," as ").concat(l.sqlFields.category," FROM ").concat(this.resolveTableName())}},{key:"rangeCondition",value:function(e,t,n,a){var i=e;return n.forEach((function(e,n){var r="date"===a?"'".concat(e,"'"):e,o="";0===n?o="".concat(t," >= ").concat(r):1===n&&(o="".concat(o," AND ").concat(t," <= ").concat(r)),i="".concat(i," ").concat(o)})),i}},{key:"prepareFilters",value:function(){var e=this,t=this.configuration.filters,n="WHERE";t&&Array.isArray(t)&&t.length>0&&t.forEach((function(t){var a=t.name,i=t.value,r=t.type;if(!(i&&Array.isArray(i)&&2===i.length))throw new Error("Expected value range filter recived (".concat(i.join(),"), not yet implemented in filter service."));n=e.rangeCondition(n,a,i,r)})),this.sql="".concat(this.sql," ").concat(n)}},{key:"prepareGroupBy",value:function(){var e=this.configuration,t=e.groupBy,n=e.aggregateFunction;if(t){var a=t.name;this.sql="".concat(this.sql," GROUP BY ").concat(a||l.sqlFields.value)}else n&&"none"!==n&&(this.sql="".concat(this.sql," GROUP BY ").concat(l.sqlFields.value))}},{key:"prepareOrderBy",value:function(){var e=this.configuration.orderBy;if(e){var t=e.name;this.sql="".concat(this.sql," ORDER BY ").concat(t||l.sqlFields.category)}}},{key:"prepareOrder",value:function(){var e=this.configuration.orderBy;if(e){var t=e.orderType;this.sql="".concat(this.sql," ").concat(t||"desc")}}},{key:"prepareLimit",value:function(){var e=this.configuration.limit,t=void 0===e?500:e;this.sql="".concat(this.sql," LIMIT ").concat(t)}},{key:"requestWidgetData",value:function(){return o(this,void 0,void 0,a.mark((function e(){var t,n;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.datasetId){e.next=2;break}throw new Error("Error, datasetId not present in Filters service.");case 2:return e.next=4,fetch("https://api.resourcewatch.org/v1/query/".concat(this.datasetId,"?sql=").concat(this.sql));case 4:return t=e.sent,e.next=7,t.json();case 7:return n=e.sent,e.abrupt("return",n);case 9:case"end":return e.stop()}}),e,this)})))}}],[{key:"baseFilter",value:function(e,t,n,a){return{column:t,indicator:Array.isArray(e)||2===e.length?"range":"value",id:"we-filter-".concat(t,"-").concat(a),dataType:n,filter:{values:e,notNull:!0}}}},{key:"patchFilters",value:function(e,t,n,i,r){return o(this,void 0,void 0,a.mark((function o(){var c,l;return a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t.values,t.id,t.type,c=new s.default(n,i,r),a.next=4,u.default(e,c,t);case 4:return l=a.sent,a.abrupt("return",l);case 6:case"end":return a.stop()}}),o)})))}}]),e}();t.default=d},97:function(e,t,n){"use strict";var a=n(6),i=n(24),r=n(25),o=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function o(e){try{s(a.next(e))}catch(t){r(t)}}function c(e){try{s(a.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}s((a=a.apply(e,t||[])).next())}))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=c(n(162)),l=function(){function e(t,n,a){i(this,e),this.NUMERIC_TYPE="number",this.COLUMN_TYPE="string",this.configuration=t,this.datasetId=n,this.fields=a}return r(e,[{key:"query",value:function(e){return fetch("https://api.resourcewatch.org/v1/query/".concat(this.datasetId,"?").concat(e)).then((function(e){if(e.status>=400)throw new Error(e.statusText);return e.json()})).then((function(e){return e.data}))}},{key:"getColumnMinAndMax",value:function(e){var t=e.columnName,n=this.configuration.value.tableName,a="SELECT MIN(".concat(t,") AS min, MAX(").concat(t,") AS max FROM ").concat(n);return this.query("sql=".concat(a)).then((function(e){return e?e[0]:{}}))}},{key:"getColumnValues",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.columnName,a=this.configuration.value.tableName,i=t?"GROUP BY ".concat(n):"",r="SELECT ".concat(n," FROM ").concat(a," ").concat(i," ORDER BY ").concat(n);return this.query("sql=".concat(r)).then((function(e){return(e||[]).map((function(e){return e[n]}))}))}},{key:"getFieldInfo",value:function(e,t){return o(this,void 0,void 0,a.mark((function e(){var n,i,r;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=this.fields.find((function(e){return e.columnName===t}))).type!==this.NUMERIC_TYPE){e.next=6;break}return e.next=4,this.getColumnMinAndMax(n);case 4:return i=e.sent,e.abrupt("return",i);case 6:if(n.type!==this.COLUMN_TYPE){e.next=11;break}return e.next=9,this.getColumnValues(n);case 9:return r=e.sent,e.abrupt("return",r.map((function(e){return{value:e,label:s.default(e)}})));case 11:return e.abrupt("return","Hello world");case 12:case"end":return e.stop()}}),e,this)})))}}]),e}();t.default=l},98:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.APP_NAMESPACE="widgetEditor",t.ALLOWED_FIELD_TYPES=[{name:"esriFieldTypeSmallInteger",type:"number",provider:"esri"},{name:"esriFieldTypeInteger",type:"number",provider:"esri"},{name:"esriFieldTypeSingle",type:"number",provider:"esri"},{name:"esriFieldTypeDouble",type:"number",provider:"esri"},{name:"numeric",type:"number",provider:"psql"},{name:"number",type:"number",provider:"carto"},{name:"int",type:"number",provider:"psql"},{name:"integer",type:"number",provider:"psql"},{name:"float",type:"number",provider:"sql"},{name:"long",type:"number",provider:"sql"},{name:"double",type:"number",provider:"sql"},{name:"real",type:"number",provider:"sql"},{name:"decimal",type:"number",provider:"sql"},{name:"string",type:"string",provider:"sql"},{name:"char",type:"string",provider:"sql"},{name:"varchar",type:"string",provider:"sql"},{name:"esriFieldTypeString",type:"string",provider:"esri"},{name:"text",type:"string",provider:"elastic"},{name:"esriFieldTypeDate",type:"date",provider:"esri"},{name:"date",type:"date",provider:"sql"},{name:"time",type:"date",provider:"sql"},{name:"timestamp",type:"date",provider:"sql"},{name:"interval",type:"date",provider:"sql"},{name:"boolean",type:"boolean",provider:"sql"},{name:"array",type:"array",provider:"sql"}],t.sagaEvents={DATA_FLOW_DATASET_WIDGET_READY:"".concat(t.APP_NAMESPACE,"/SAGAS/DATA_FLOW/dataset_widget_ready"),DATA_FLOW_DATA_READY:"".concat(t.APP_NAMESPACE,"/SAGAS/DATA_FLOW/data_ready"),DATA_FLOW_VISUALISATION_READY:"".concat(t.APP_NAMESPACE,"/SAGAS/DATA_FLOW/visualisation_ready"),DATA_FLOW_WIDGET_DATA_READY:"".concat(t.APP_NAMESPACE,"/SAGAS/DATA_FLOW/visualisation_ready"),DATA_FLOW_PROXY_UPDATE:"".concat(t.APP_NAMESPACE,"/SAGAS/DATA_FLOW/proxy_update"),EDITOR_SAVE:"".concat(t.APP_NAMESPACE,"/CONFIGURATION/saveConfiguration")},t.reduxActions={EDITOR_SET_CONFIGURATION:"".concat(t.APP_NAMESPACE,"/CONFIGURATION/setConfiguration"),EDITOR_SET_WIDGET:"".concat(t.APP_NAMESPACE,"/WIDGET/setWidget"),EDITOR_SET_FILTERS:"".concat(t.APP_NAMESPACE,"/EDITOR/setFilters")},t.default={APP_NAMESPACE:t.APP_NAMESPACE,sagaEvents:t.sagaEvents,reduxActions:t.reduxActions}}},[[149,1,2]]]);
//# sourceMappingURL=main.0f1eec21.chunk.js.map